

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>SVD (Singular Value Decomposition) &#8212; AI primer</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/mystnb.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="RF (Random Forest)" href="RF.html" />
    <link rel="prev" title="Welcome to AI primer course" href="README.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  
  <h1 class="site-logo" id="site-title">AI primer</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  
  <ul class="nav sidenav_l1">
  <li class="">
    <a href="README.html">Welcome to AI primer course</a>
  </li>
  <li class="active">
    <a href="">SVD (Singular Value Decomposition)</a>
  </li>
  <li class="">
    <a href="RF.html">RF (Random Forest)</a>
  </li>
  <li class="">
    <a href="DNN.html">DNN (Deep Neural Networks)</a>
  </li>
  <li class="">
    <a href="CNN.html">CNN (Convolutional Neural Networks)</a>
  </li>
  <li class="">
    <a href="Project.html">Project: Flatland</a>
  </li>
</ul>
</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse" data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu" aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation" title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
            <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i class="fas fa-download"></i></button>

            
            <div class="dropdown-buttons">
                <!-- ipynb file if we had a myst markdown file -->
                
                <!-- Download raw file -->
                <a class="dropdown-buttons" href="_sources/SVD.ipynb"><button type="button" class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip" data-placement="left">.ipynb</button></a>
                <!-- Download PDF via print -->
                <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF" onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
            </div>
            
        </div>

        <!-- Edit this page -->
        

        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->
        
    </div>
    <div class="d-none d-md-block col-md-2 bd-toc show">
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#increasing-importance-of-linear-algebra" class="nav-link">Increasing importance of linear algebra</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#linear-algebra-missing-pieces" class="nav-link">Linear algebra (missing pieces?)</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#matrix-vector-multiplication" class="nav-link">Matrix-vector multiplication</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#eigenvectors" class="nav-link">Eigenvectors</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#how-to-calculate-eigenvectors" class="nav-link">How to calculate eigenvectors</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#singular-value-decomposition-svd" class="nav-link">Singular Value Decomposition (SVD)</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#how-is-svd-computed" class="nav-link">How is SVD computed?</a>
        </li>
    
            </ul>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#using-svd-to-compress-images" class="nav-link">Using SVD to compress images</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#svd-for-linear-regression" class="nav-link">SVD for linear regression</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#pca-principal-component-analysis" class="nav-link">PCA (Principal Component analysis)</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#recommender-using-svd" class="nav-link">Recommender using SVD</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#simplest-recommender" class="nav-link">Simplest recommender</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#movielense-dataset" class="nav-link">MovieLense dataset</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#re-sources" class="nav-link">(re)Sources</a>
        </li>
    
    </ul>
</nav>


    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="svd-singular-value-decomposition">
<h1>SVD (Singular Value Decomposition)<a class="headerlink" href="#svd-singular-value-decomposition" title="Permalink to this headline">¶</a></h1>
<p>What we will cover in this page:</p>
<ul class="simple">
<li><p>Increasing importance of linear algebra</p></li>
<li><p>Singular Value Decomposition (SVD)</p></li>
<li><p>Using SVD to compress images</p></li>
<li><p>Recommender using SVD</p></li>
<li><p>SVD for linear regression</p></li>
</ul>
<div class="section" id="increasing-importance-of-linear-algebra">
<h2>Increasing importance of linear algebra<a class="headerlink" href="#increasing-importance-of-linear-algebra" title="Permalink to this headline">¶</a></h2>
<p>In 1844 Hermann Grassmann published his “Theory of Extension” which included foundational new topics of what is today called <strong>linear algebra</strong>. In 1848, James Joseph Sylvester introduced the term <strong>matrix</strong>, which is Latin for womb.
Linear algebra is the branch of mathematics concerning linear equations such as
<span class="math notranslate nohighlight">\($a_{1}x_{1}+\cdots +a_{n}x_{n}=b\)</span>$ and linear functions such as <span class="math notranslate nohighlight">\($(x_{1},\ldots ,x_{n})\mapsto a_{1}x_{1}+\ldots +a_{n}x_{n}\)</span>$
and their representations through <strong>matrices and vector spaces</strong>. Linear algebra is increasing in importance as is core tool in AI field. Nice <a class="reference external" href="https://lexfridman.com/gilbert-strang/">podcast</a> about this increasing importance, Strang even suggests to replace calculus by linear albebra in schools. By the way most calculus operations have discrete analogues in linear algebra.</p>
<div class="section" id="linear-algebra-missing-pieces">
<h3>Linear algebra (missing pieces?)<a class="headerlink" href="#linear-algebra-missing-pieces" title="Permalink to this headline">¶</a></h3>
<p>Since you know linear algebra well I just want to point out some important things which often are left forgotten:</p>
<ul class="simple">
<li><p>Algebra has geometric interpretation</p></li>
<li><p>Usually you can think about algebraic objects and operations in alternative ways and that can open up some doors</p></li>
</ul>
<p>Here are couple examples to prove these points and give you some intuition.</p>
<div class="section" id="matrix-vector-multiplication">
<h4>Matrix-vector multiplication<a class="headerlink" href="#matrix-vector-multiplication" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>Matrix is a collection of vectors</p></li>
<li><p>A matrix maps one vector to another vector</p></li>
<li><p>Matrix times vector can be thought of as a weighted sum of matrix columns</p></li>
</ul>
<img src="https://eli.thegreenplace.net/images/2015/veccomb.png" alt="Matrix times vector" style="width: 50%"/>
<img src="https://eli.thegreenplace.net/images/2015/vecrowcomb.png" alt="Vector times matrix" style="width: 50%"/>
<p>So if we multiply a space by a matrix it enables us to <strong>stretch and rotate</strong> original space.</p>
<img src="https://i.ytimg.com/vi/XkY2DOUCWMU/maxresdefault.jpg" alt="Space deformation" style="width: 50%"/>
<p>For example</p>
<p>\begin{bmatrix}
\cos(\theta) &amp; -\sin(\theta)\
\sin(\theta) &amp; \cos(\theta)
\end{bmatrix}</p>
<p>works as a simple counter-clockwise rotation, and it’s inverse as clockwise rotation. For more geometric interpretations see <strong>3Blue1Brown</strong> <a class="reference external" href="https://www.youtube.com/watch?v=kjBOesZCoqc&amp;feature=emb_title">linear algebra</a> course.</p>
</div>
</div>
<div class="section" id="eigenvectors">
<h3>Eigenvectors<a class="headerlink" href="#eigenvectors" title="Permalink to this headline">¶</a></h3>
<p><strong>Suggested reading:</strong> <a class="reference external" href="https://www.math.arizona.edu/~glickenstein/math443f08/bryanleise.pdf">THE $25,000,000,000 EIGENVECTOR THE LINEAR ALGEBRA BEHIND GOOGLE</a></p>
<p>So if vector multiplied by a matrix is a stretch and rotation, then axes of rotation can be especially useful. These axes are called eigenvectors and are easy to define, we just formalize the fact that rotation does nothing by <span class="math notranslate nohighlight">\(A u=\lambda u\)</span>, where <span class="math notranslate nohighlight">\(\lambda\)</span> is a scalar (eigenvalue).</p>
<p>An eigenvector (eigen means ‘specific’ in German) is a vector whose direction remains unchanged when a linear transformation is applied to it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]])</span>

<span class="n">values</span><span class="p">,</span> <span class="n">vectors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Eigenvalues:</span><span class="se">\n</span><span class="si">{</span><span class="n">values</span><span class="si">}</span><span class="se">\n</span><span class="s1">Eigenvectors:</span><span class="se">\n</span><span class="si">{</span><span class="n">vectors</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Eigenvalues:
[-1. -2.]
Eigenvectors:
[[ 1.         -0.70710678]
 [ 0.          0.70710678]]
</pre></div>
</div>
</div>
</div>
<p>Let’s see what’s going on here.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">20</span><span class="p">)),</span> <span class="n">vectors</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">20</span><span class="p">)),</span> <span class="n">vectors</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">scale_units</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">U_proj</span><span class="p">,</span> <span class="n">V_proj</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">]))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">U_proj</span><span class="p">,</span> <span class="n">V_proj</span><span class="p">,</span> <span class="n">scale_units</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/SVD_4_0.png" src="_images/SVD_4_0.png" />
</div>
</div>
<p><strong>TASK:</strong> play a bit and make sure that it works as expected and you can use basic <em>numpy</em> functions easily (for example <em>np.dot</em>), we will need it a lot in the future.</p>
<p><strong>TASK:</strong> play with a matrix
<span class="math notranslate nohighlight">\(\begin{bmatrix}
3 &amp; 1\\
1 &amp; 2
\end{bmatrix}\)</span>,
can you tell what it does to the vectorspace and where eigenvectors are located? Do they have a clear interpretation?</p>
<p>Some of the things you might discover will work only for symmetric matrixes (those which are equal to its own transpose). Keep that in mind, later we will intentionally produce symmetric matrixes.</p>
</div>
<div class="section" id="how-to-calculate-eigenvectors">
<h3>How to calculate eigenvectors<a class="headerlink" href="#how-to-calculate-eigenvectors" title="Permalink to this headline">¶</a></h3>
<p>You might know that already, but let’s run through quick example to get some intuition. Let</p>
<div class="math notranslate nohighlight">
\[\begin{split}A = \begin{bmatrix}
2 &amp; 3\\
2 &amp; 1
\end{bmatrix}\end{split}\]</div>
<p>Since we are solving for <span class="math notranslate nohighlight">\(A u=\lambda u\)</span> it is the same as to request that <span class="math notranslate nohighlight">\(A - \lambda I = 0\)</span> or</p>
<div class="math notranslate nohighlight">
\[\begin{split}\det\begin{pmatrix}
2 - \lambda &amp; 3\\
2 &amp; 1 - \lambda
\end{pmatrix} = 0.\end{split}\]</div>
<p>After solving it you end up with two eigenvalues <span class="math notranslate nohighlight">\(\lambda_1 = -1\)</span> and <span class="math notranslate nohighlight">\(\lambda_2 = 4\)</span>. The eigenvalue specifies the size of the eigenvector, let’s find those now. By solving system of equations defined by <span class="math notranslate nohighlight">\(Au_1 = -u_1\)</span> you should get <span class="math notranslate nohighlight">\(u_1 = \begin{bmatrix}-1\\1\end{bmatrix}\)</span> and <span class="math notranslate nohighlight">\(Au_2 = 4u_2\)</span> quickly leads to <span class="math notranslate nohighlight">\(u_2 = \begin{bmatrix}3\\2\end{bmatrix}\)</span>.</p>
<p><strong>TASK:</strong> confirm these calculations using numpy.</p>
</div>
<div class="section" id="singular-value-decomposition-svd">
<h3>Singular Value Decomposition (SVD)<a class="headerlink" href="#singular-value-decomposition-svd" title="Permalink to this headline">¶</a></h3>
<p>We can decompose matrix any way we like, for example: <span class="math notranslate nohighlight">\(A = B + C\)</span>, <span class="math notranslate nohighlight">\(A = B \cdot C\)</span>, … It turns out that some decompositions are usefull for data compression, numerical calculations and might reveal insights into the data. SVD is defined as:</p>
<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/c8/Singular_value_decomposition_visualisation.svg/220px-Singular_value_decomposition_visualisation.svg.png" alt="SVD" style="width: 20%"/>
<p>Who invented SVD?</p>
<ul class="simple">
<li><p>Eugenio Beltrami (1835-1899)</p></li>
<li><p>Camille Jordan (1838-1921)</p></li>
<li><p>James Joseph Sylvester (1814-1897)</p></li>
<li><p>Erhard Schmidt (1876-1959)</p></li>
<li><p>Hermann Weyl (1885- 1955)</p></li>
</ul>
<p>For early history see this paper. Fun fact: Gauss used matrix decomposition in 1823.</p>
<p>SVD is videly used in:</p>
<ul class="simple">
<li><p>Data compression</p></li>
<li><p>Recommender systems</p></li>
<li><p>Linear regressions</p></li>
<li><p>NLP (natural language processing)</p></li>
<li><p>PCA (principal component analysis)</p></li>
</ul>
<p>We will see some examples bellow starting from data compression.</p>
<div class="section" id="how-is-svd-computed">
<h4>How is SVD computed?<a class="headerlink" href="#how-is-svd-computed" title="Permalink to this headline">¶</a></h4>
<p>Let’s compute SVD for
<span class="math notranslate nohighlight">\($X=
\begin{bmatrix}
5 &amp; 5\\
-1 &amp; 7
\end{bmatrix} = USV^T.\)</span>$</p>
<p>We start by producing symmetric matrix (you should have some intuition why we need that by now)
<span class="math notranslate nohighlight">\($X^T X=VS^TSV^T=
\begin{bmatrix}
26 &amp; 18\\
18 &amp; 74
\end{bmatrix} = USV^T.\)</span>$</p>
<p>Now we can compute eigenvectors usging determinant. Since
<span class="math notranslate nohighlight">\($\det(X^TX - \lambda I) = (\lambda - 20)(\lambda - 80)\)</span>$
we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}X^TX - 80 I =
\begin{bmatrix}
-54 &amp; 18\\
18 &amp; -6
\end{bmatrix}
\rightarrow
V_1 = \frac{1}{\sqrt{10}}
\begin{bmatrix}
1\\
3
\end{bmatrix}.\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}X^TX - 20 I = 
\begin{bmatrix}
6 &amp; 18\\
18 &amp; 54
\end{bmatrix}
\rightarrow
V_2 = \frac{1}{\sqrt{10}}
\begin{bmatrix}
3\\
-1
\end{bmatrix};\end{split}\]</div>
<p>Now we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}V = \frac{1}{\sqrt{10}}
\begin{bmatrix}
1 &amp; 3\\
3 &amp; -1
\end{bmatrix},\end{split}\]</div>
<p>thus knowing that <span class="math notranslate nohighlight">\(XV=US\)</span> it is easy to find</p>
<div class="math notranslate nohighlight">
\[\begin{split}S =
\begin{bmatrix}
4\sqrt{5} &amp; 0\\
0 &amp; 2\sqrt{5}
\end{bmatrix};\;
U = \frac{1}{\sqrt{2}}
\begin{bmatrix}
1 &amp; 1\\
1 &amp; -1
\end{bmatrix}.\end{split}\]</div>
<p>Let’s confirm our results using numpy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
              <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">]])</span>

<span class="n">U</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;U</span><span class="se">\n</span><span class="si">{</span><span class="n">U</span><span class="si">}</span><span class="se">\n</span><span class="s1">S</span><span class="se">\n</span><span class="si">{</span><span class="n">S</span><span class="si">}</span><span class="se">\n</span><span class="s1">V</span><span class="se">\n</span><span class="si">{</span><span class="n">V</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>U
[[ 0.70710678  0.70710678]
 [ 0.70710678 -0.70710678]]
S
[8.94427191 4.47213595]
V
[[ 0.31622777  0.9486833 ]
 [ 0.9486833  -0.31622777]]
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="using-svd-to-compress-images">
<h2>Using SVD to compress images<a class="headerlink" href="#using-svd-to-compress-images" title="Permalink to this headline">¶</a></h2>
<p>We will use the following trick to compress images:</p>
<ul class="simple">
<li><p>Calculate SVD of an image</p></li>
<li><p>Leave only top N factors in S</p></li>
<li><p>Multiply matrixes to obtaine compressed image</p></li>
</ul>
<img src="https://image1.slideserve.com/2598122/svd-and-rank-k-approximations-l.jpg" alt="Rank-k approximation" style="width: 50%"/>
<p>As we saw this should work, because S captures most relevant eigenvectors.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>    <span class="c1"># pip install matplotlib</span>
<span class="kn">from</span> <span class="nn">IPython</span> <span class="kn">import</span> <span class="n">display</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>
<span class="kn">import</span> <span class="nn">cv2</span>                         <span class="c1"># pip install opencv-python</span>

<span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Just a little helper function to get a nice image plot&quot;&quot;&quot;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="mi">255</span> <span class="k">if</span> <span class="n">X</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">1</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">m</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;img/flud.jpg&#39;</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">IMREAD_GRAYSCALE</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Image shape </span><span class="si">{</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Image shape (503, 800)
</pre></div>
</div>
<img alt="_images/SVD_13_1.png" src="_images/SVD_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate number of values in SVD&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">u</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">s</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>First, let’s use all singular values. Even then we reach some compression!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">U</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;U shape - </span><span class="si">{0}</span><span class="se">\n</span><span class="s1">S shape - </span><span class="si">{1}</span><span class="se">\n</span><span class="s1">V shape - </span><span class="si">{2}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">V</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="n">plot</span><span class="p">((</span><span class="n">U</span> <span class="o">*</span> <span class="n">S</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">V</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">S</span><span class="p">)]))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Compression rate with all singular values - </span><span class="si">{0:.02%}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="mi">1</span> <span class="o">-</span> <span class="n">size</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">V</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">S</span><span class="p">)])</span> <span class="o">/</span> <span class="n">size</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">V</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>U shape - (503, 503)
S shape - (503,)
V shape - (800, 800)
</pre></div>
</div>
<img alt="_images/SVD_16_1.png" src="_images/SVD_16_1.png" />
</div>
</div>
<p><strong>TASK:</strong> check if all values of <code class="docutils literal notranslate"><span class="pre">(U</span> <span class="pre">*</span> <span class="pre">S).dot(V[:len(S)])</span></code> match <code class="docutils literal notranslate"><span class="pre">X</span></code> using numpy.</p>
<p>Let’s try to use only top singular values thus compressing image even more.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">U</span><span class="p">[:,:</span><span class="n">i</span><span class="p">]</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">S</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">V</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span>
    <span class="n">plot</span><span class="p">((</span><span class="n">u</span> <span class="o">*</span> <span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Using </span><span class="si">{0}</span><span class="s1"> singular values, compression rate = </span><span class="si">{1:.02%}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">i</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">size</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="o">/</span> <span class="n">size</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">V</span><span class="p">)))</span>
    <span class="n">display</span><span class="o">.</span><span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">display</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">())</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/SVD_19_0.png" src="_images/SVD_19_0.png" />
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 432x288 with 0 Axes&gt;
</pre></div>
</div>
</div>
</div>
<p>Note, that first singular values capture most of the information and thus lead to high compression rate.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Singular values&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/SVD_21_0.png" src="_images/SVD_21_0.png" />
</div>
</div>
<p><strong>TASK:</strong> play with animation and explore U, S, V, how many numbers do you need to transmit comprehensible image?</p>
</div>
<div class="section" id="svd-for-linear-regression">
<h2>SVD for linear regression<a class="headerlink" href="#svd-for-linear-regression" title="Permalink to this headline">¶</a></h2>
<p>As you might know inverses are computationally unstable, for example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.linalg</span> <span class="kn">import</span> <span class="n">hilbert</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">hilbert</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>For sure we expect <span class="math notranslate nohighlight">\((X^{-1})^{-1} = X\)</span>, but</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">X</span><span class="p">))</span> <span class="o">-</span> <span class="n">X</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Errors obtained by $(X^{-1})^{-1} - X$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/SVD_26_0.png" src="_images/SVD_26_0.png" />
</div>
</div>
<p>Further computations might lead to even higher errors, for example we would expect <span class="math notranslate nohighlight">\(X^{-1} X v = v\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">-</span> <span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[ 2.54168321e-04 -2.16246846e-03  5.54641009e-03 -5.06685157e-03
 -8.80313369e-04  3.72902505e-03 -1.29186754e-03 -2.74052998e-04
  3.00842378e-04 -4.69960481e-05]
</pre></div>
</div>
</div>
</div>
<p>Linear regression works by
<span class="math notranslate nohighlight">\($y=X\hat\beta\)</span>$
<span class="math notranslate nohighlight">\($X^Ty=X^TX\hat\beta\)</span>$
<span class="math notranslate nohighlight">\($\hat \beta = (X^T X)^{-1} X^T y\)</span>$</p>
<p>By the way you can vizualize linear regression as the process of minimizing <span class="math notranslate nohighlight">\(e\)</span> in</p>
<img src="https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcQXvIwYtFpyuHEa_0zYoECXKp3JRdf6Q89eo3Prpw9SvJBJoLmC" alt="Linear regression" style="width: 40%"/>
<p>thus it’s analogue of finding a projection of target vector in a given vector space.</p>
<p>Let’s come back to our problem - we saw that inverse is unstable… SVD is one of the solutions to deal with that problem.</p>
<p>Since <span class="math notranslate nohighlight">\($X=USV^T\)</span>$ and <span class="math notranslate nohighlight">\($UU^T=I_m;\;VV^T=I_n\)</span>$ it is easy to show that <span class="math notranslate nohighlight">\($\hat \beta = (X^T X)^{-1} X^T y = V S^{-1} U^T y.\)</span>$</p>
<p><strong>Note:</strong> inverse of S is known to be stable.</p>
<p>Let’s see if this trick realy works on a real dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_boston</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">load_boston</span><span class="p">()</span><span class="o">.</span><span class="n">data</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">load_boston</span><span class="p">()</span><span class="o">.</span><span class="n">target</span>
<span class="c1"># add ones to dataset </span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">506</span><span class="p">)[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="n">X</span><span class="p">])</span>
<span class="c1"># calculate beta using direct inverse</span>
<span class="n">beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">))</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Calculate beta using direct inverse</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">))</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RMSE = </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">X</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>RMSE = 21.894831181729202
</pre></div>
</div>
</div>
</div>
<p>Calculate using SVD</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">U</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">S</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">14</span><span class="p">,</span> <span class="mi">492</span><span class="p">))])</span><span class="o">.</span><span class="n">T</span>    <span class="c1"># X ~ U.dot(S).dot(V)</span>
<span class="n">beta_svd</span> <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">S</span><span class="p">))</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RMSE = </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">X</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">beta_svd</span><span class="p">)</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>RMSE = 21.8948311817292
</pre></div>
</div>
</div>
</div>
<p><strong>Note:</strong> sklearn and most other libraries use SVD for regression.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">load_boston</span><span class="p">()</span><span class="o">.</span><span class="n">data</span>   <span class="c1"># we do not need to add 1&#39;s column now</span>
<span class="n">lr</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RMSE = </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">pred</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>RMSE = 21.894831181729202
</pre></div>
</div>
</div>
</div>
<div class="section" id="pca-principal-component-analysis">
<h3>PCA (Principal Component analysis)<a class="headerlink" href="#pca-principal-component-analysis" title="Permalink to this headline">¶</a></h3>
<p>Similarly as with images SVD can be used to reveal most important components of the given dataset and thus lead to data compression. The process is called Principal Component analysis (PCA) as is executed as follows:</p>
<ol class="simple">
<li><p>Make sure that your dataset has samples in rows and variables in columns.</p></li>
<li><p>Subtract mean and divide by standard deviation to normalize each variable to get <span class="math notranslate nohighlight">\(X\)</span>.</p></li>
<li><p>Calculate SVD by computing <span class="math notranslate nohighlight">\(X=USV^T\)</span>.</p></li>
<li><p>Treat <span class="math notranslate nohighlight">\(V\)</span> are principal directions/axes and <span class="math notranslate nohighlight">\(US\)</span> are principal components/scores.</p></li>
</ol>
<p><strong>NOTE:</strong> make shure that you can explain why each step is needed. If you need more explanation, read throuw this <a class="reference external" href="https://stats.stackexchange.com/questions/134282/relationship-between-svd-and-pca-how-to-use-svd-to-perform-pca">discussion</a>, it contains some good links too.</p>
<p>This is a neat trick if we want to apply simple model (for example linear regression) on high dimensional datasets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span> <span class="o">-</span> <span class="n">X</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span> <span class="o">/</span> <span class="n">X</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>    <span class="c1"># this is called Standard Scaling</span>
<span class="n">U</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="n">i</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">U</span><span class="p">[:,:</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">S</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span>    <span class="c1"># principal components</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([[-2.09829747,  0.77311275,  0.34294273,  0.89177403],
       [-1.45725167,  0.59198521, -0.69519931,  0.48745853],
       [-2.07459756,  0.5996394 ,  0.1671216 ,  0.73920419],
       ...,
       [-0.31236047,  1.15524644, -0.40859759,  0.78630409],
       [-0.27051907,  1.04136158, -0.58545406,  0.67813391],
       [-0.12580322,  0.76197805, -1.294882  ,  0.2883292 ]])
</pre></div>
</div>
</div>
</div>
<p>Just to confirm that we interpreted SVD correctly this is sklearn implementation of PCA.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>

<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">pca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([[-2.09829747,  0.77311275,  0.34294273, -0.89177403],
       [-1.45725167,  0.59198521, -0.69519931, -0.48745853],
       [-2.07459756,  0.5996394 ,  0.1671216 , -0.73920419],
       ...,
       [-0.31236047,  1.15524644, -0.40859759, -0.78630409],
       [-0.27051907,  1.04136158, -0.58545406, -0.67813391],
       [-0.12580322,  0.76197805, -1.294882  , -0.2883292 ]])
</pre></div>
</div>
</div>
</div>
<p>For our simple dataset PCA does not help to improve RMSE, but keep this in your toolbox for those case where you have high number of correlated features. Also it can be used to plot high dimensional datasets by projecting them to lower dimension. Let’s take a look.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">pca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">X_proj</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_proj</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X_proj</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;First two principal components colored by price&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/SVD_42_0.png" src="_images/SVD_42_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="recommender-using-svd">
<h2>Recommender using SVD<a class="headerlink" href="#recommender-using-svd" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">display</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">background_gradient</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Matrix&#39;</span><span class="p">,</span> <span class="s1">&#39;Alien&#39;</span><span class="p">,</span> <span class="s1">&#39;Serenity&#39;</span><span class="p">,</span> <span class="s1">&#39;Casablanca&#39;</span><span class="p">,</span> <span class="s1">&#39;Amelie&#39;</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style  type="text/css" >
    #T_d4536e24_71ba_11ea_be1e_8c8590b50e14row0_col0 {
            background-color:  #dbdaeb;
            color:  #000000;
        }    #T_d4536e24_71ba_11ea_be1e_8c8590b50e14row0_col1 {
            background-color:  #dbdaeb;
            color:  #000000;
        }    #T_d4536e24_71ba_11ea_be1e_8c8590b50e14row0_col2 {
            background-color:  #dbdaeb;
            color:  #000000;
        }    #T_d4536e24_71ba_11ea_be1e_8c8590b50e14row0_col3 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d4536e24_71ba_11ea_be1e_8c8590b50e14row0_col4 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d4536e24_71ba_11ea_be1e_8c8590b50e14row1_col0 {
            background-color:  #4295c3;
            color:  #000000;
        }    #T_d4536e24_71ba_11ea_be1e_8c8590b50e14row1_col1 {
            background-color:  #4295c3;
            color:  #000000;
        }    #T_d4536e24_71ba_11ea_be1e_8c8590b50e14row1_col2 {
            background-color:  #4295c3;
            color:  #000000;
        }    #T_d4536e24_71ba_11ea_be1e_8c8590b50e14row1_col3 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d4536e24_71ba_11ea_be1e_8c8590b50e14row1_col4 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d4536e24_71ba_11ea_be1e_8c8590b50e14row2_col0 {
            background-color:  #0567a2;
            color:  #f1f1f1;
        }    #T_d4536e24_71ba_11ea_be1e_8c8590b50e14row2_col1 {
            background-color:  #0567a2;
            color:  #f1f1f1;
        }    #T_d4536e24_71ba_11ea_be1e_8c8590b50e14row2_col2 {
            background-color:  #0567a2;
            color:  #f1f1f1;
        }    #T_d4536e24_71ba_11ea_be1e_8c8590b50e14row2_col3 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d4536e24_71ba_11ea_be1e_8c8590b50e14row2_col4 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d4536e24_71ba_11ea_be1e_8c8590b50e14row3_col0 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d4536e24_71ba_11ea_be1e_8c8590b50e14row3_col1 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d4536e24_71ba_11ea_be1e_8c8590b50e14row3_col2 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d4536e24_71ba_11ea_be1e_8c8590b50e14row3_col3 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d4536e24_71ba_11ea_be1e_8c8590b50e14row3_col4 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d4536e24_71ba_11ea_be1e_8c8590b50e14row4_col0 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d4536e24_71ba_11ea_be1e_8c8590b50e14row4_col1 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d4536e24_71ba_11ea_be1e_8c8590b50e14row4_col2 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d4536e24_71ba_11ea_be1e_8c8590b50e14row4_col3 {
            background-color:  #0567a2;
            color:  #f1f1f1;
        }    #T_d4536e24_71ba_11ea_be1e_8c8590b50e14row4_col4 {
            background-color:  #0567a2;
            color:  #f1f1f1;
        }    #T_d4536e24_71ba_11ea_be1e_8c8590b50e14row5_col0 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d4536e24_71ba_11ea_be1e_8c8590b50e14row5_col1 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d4536e24_71ba_11ea_be1e_8c8590b50e14row5_col2 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d4536e24_71ba_11ea_be1e_8c8590b50e14row5_col3 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d4536e24_71ba_11ea_be1e_8c8590b50e14row5_col4 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d4536e24_71ba_11ea_be1e_8c8590b50e14row6_col0 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d4536e24_71ba_11ea_be1e_8c8590b50e14row6_col1 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d4536e24_71ba_11ea_be1e_8c8590b50e14row6_col2 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d4536e24_71ba_11ea_be1e_8c8590b50e14row6_col3 {
            background-color:  #9cb9d9;
            color:  #000000;
        }    #T_d4536e24_71ba_11ea_be1e_8c8590b50e14row6_col4 {
            background-color:  #9cb9d9;
            color:  #000000;
        }</style><table id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >Matrix</th>        <th class="col_heading level0 col1" >Alien</th>        <th class="col_heading level0 col2" >Serenity</th>        <th class="col_heading level0 col3" >Casablanca</th>        <th class="col_heading level0 col4" >Amelie</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14level0_row0" class="row_heading level0 row0" >0</th>
                        <td id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14row0_col0" class="data row0 col0" >1.00</td>
                        <td id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14row0_col1" class="data row0 col1" >1.00</td>
                        <td id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14row0_col2" class="data row0 col2" >1.00</td>
                        <td id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14row0_col3" class="data row0 col3" >0.00</td>
                        <td id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14row0_col4" class="data row0 col4" >0.00</td>
            </tr>
            <tr>
                        <th id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14level0_row1" class="row_heading level0 row1" >1</th>
                        <td id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14row1_col0" class="data row1 col0" >3.00</td>
                        <td id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14row1_col1" class="data row1 col1" >3.00</td>
                        <td id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14row1_col2" class="data row1 col2" >3.00</td>
                        <td id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14row1_col3" class="data row1 col3" >0.00</td>
                        <td id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14row1_col4" class="data row1 col4" >0.00</td>
            </tr>
            <tr>
                        <th id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14level0_row2" class="row_heading level0 row2" >2</th>
                        <td id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14row2_col0" class="data row2 col0" >4.00</td>
                        <td id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14row2_col1" class="data row2 col1" >4.00</td>
                        <td id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14row2_col2" class="data row2 col2" >4.00</td>
                        <td id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14row2_col3" class="data row2 col3" >0.00</td>
                        <td id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14row2_col4" class="data row2 col4" >0.00</td>
            </tr>
            <tr>
                        <th id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14level0_row3" class="row_heading level0 row3" >3</th>
                        <td id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14row3_col0" class="data row3 col0" >5.00</td>
                        <td id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14row3_col1" class="data row3 col1" >5.00</td>
                        <td id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14row3_col2" class="data row3 col2" >5.00</td>
                        <td id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14row3_col3" class="data row3 col3" >0.00</td>
                        <td id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14row3_col4" class="data row3 col4" >0.00</td>
            </tr>
            <tr>
                        <th id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14level0_row4" class="row_heading level0 row4" >4</th>
                        <td id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14row4_col0" class="data row4 col0" >0.00</td>
                        <td id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14row4_col1" class="data row4 col1" >0.00</td>
                        <td id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14row4_col2" class="data row4 col2" >0.00</td>
                        <td id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14row4_col3" class="data row4 col3" >4.00</td>
                        <td id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14row4_col4" class="data row4 col4" >4.00</td>
            </tr>
            <tr>
                        <th id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14level0_row5" class="row_heading level0 row5" >5</th>
                        <td id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14row5_col0" class="data row5 col0" >0.00</td>
                        <td id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14row5_col1" class="data row5 col1" >0.00</td>
                        <td id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14row5_col2" class="data row5 col2" >0.00</td>
                        <td id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14row5_col3" class="data row5 col3" >5.00</td>
                        <td id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14row5_col4" class="data row5 col4" >5.00</td>
            </tr>
            <tr>
                        <th id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14level0_row6" class="row_heading level0 row6" >6</th>
                        <td id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14row6_col0" class="data row6 col0" >0.00</td>
                        <td id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14row6_col1" class="data row6 col1" >0.00</td>
                        <td id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14row6_col2" class="data row6 col2" >0.00</td>
                        <td id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14row6_col3" class="data row6 col3" >2.00</td>
                        <td id="T_d4536e24_71ba_11ea_be1e_8c8590b50e14row6_col4" class="data row6 col4" >2.00</td>
            </tr>
    </tbody></table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">U</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style  type="text/css" >
    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row0_col0 {
            background-color:  #0567a2;
            color:  #f1f1f1;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row0_col1 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row0_col2 {
            background-color:  #0569a4;
            color:  #f1f1f1;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row0_col3 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row0_col4 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row0_col5 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row0_col6 {
            background-color:  #a4bcda;
            color:  #000000;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row1_col0 {
            background-color:  #9cb9d9;
            color:  #000000;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row1_col1 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row1_col2 {
            background-color:  #5c9fc9;
            color:  #000000;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row1_col3 {
            background-color:  #c8cde4;
            color:  #000000;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row1_col4 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row1_col5 {
            background-color:  #2987bc;
            color:  #000000;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row1_col6 {
            background-color:  #cccfe5;
            color:  #000000;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row2_col0 {
            background-color:  #dbdaeb;
            color:  #000000;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row2_col1 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row2_col2 {
            background-color:  #4496c3;
            color:  #000000;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row2_col3 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row2_col4 {
            background-color:  #e2dfee;
            color:  #000000;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row2_col5 {
            background-color:  #0f76b3;
            color:  #f1f1f1;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row2_col6 {
            background-color:  #c4cbe3;
            color:  #000000;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row3_col0 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row3_col1 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row3_col2 {
            background-color:  #f1ebf4;
            color:  #000000;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row3_col3 {
            background-color:  #e2dfee;
            color:  #000000;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row3_col4 {
            background-color:  #ece7f2;
            color:  #000000;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row3_col5 {
            background-color:  #fcf4fa;
            color:  #000000;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row3_col6 {
            background-color:  #f8f1f8;
            color:  #000000;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row4_col0 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row4_col1 {
            background-color:  #dbdaeb;
            color:  #000000;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row4_col2 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row4_col3 {
            background-color:  #8eb3d5;
            color:  #000000;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row4_col4 {
            background-color:  #b5c4df;
            color:  #000000;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row4_col5 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row4_col6 {
            background-color:  #f9f2f8;
            color:  #000000;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row5_col0 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row5_col1 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row5_col2 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row5_col3 {
            background-color:  #8eb3d5;
            color:  #000000;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row5_col4 {
            background-color:  #b5c4df;
            color:  #000000;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row5_col5 {
            background-color:  #034d79;
            color:  #f1f1f1;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row5_col6 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row6_col0 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row6_col1 {
            background-color:  #4295c3;
            color:  #000000;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row6_col2 {
            background-color:  #d2d2e7;
            color:  #000000;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row6_col3 {
            background-color:  #8eb3d5;
            color:  #000000;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row6_col4 {
            background-color:  #b5c4df;
            color:  #000000;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row6_col5 {
            background-color:  #d5d5e8;
            color:  #000000;
        }    #T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row6_col6 {
            background-color:  #023858;
            color:  #f1f1f1;
        }</style><table id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >0</th>        <th class="col_heading level0 col1" >1</th>        <th class="col_heading level0 col2" >2</th>        <th class="col_heading level0 col3" >3</th>        <th class="col_heading level0 col4" >4</th>        <th class="col_heading level0 col5" >5</th>        <th class="col_heading level0 col6" >6</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14level0_row0" class="row_heading level0 row0" >0</th>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row0_col0" class="data row0 col0" >-0.14</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row0_col1" class="data row0 col1" >0.00</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row0_col2" class="data row0 col2" >0.42</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row0_col3" class="data row0 col3" >-0.56</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row0_col4" class="data row0 col4" >-0.42</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row0_col5" class="data row0 col5" >0.52</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row0_col6" class="data row0 col6" >0.21</td>
            </tr>
            <tr>
                        <th id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14level0_row1" class="row_heading level0 row1" >1</th>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row1_col0" class="data row1 col0" >-0.42</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row1_col1" class="data row1 col1" >0.00</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row1_col2" class="data row1 col2" >0.15</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row1_col3" class="data row1 col3" >-0.21</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row1_col4" class="data row1 col4" >0.85</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row1_col5" class="data row1 col5" >0.19</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row1_col6" class="data row1 col6" >0.08</td>
            </tr>
            <tr>
                        <th id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14level0_row2" class="row_heading level0 row2" >2</th>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row2_col0" class="data row2 col0" >-0.56</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row2_col1" class="data row2 col1" >0.00</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row2_col2" class="data row2 col2" >0.21</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row2_col3" class="data row2 col3" >0.72</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row2_col4" class="data row2 col4" >-0.21</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row2_col5" class="data row2 col5" >0.26</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row2_col6" class="data row2 col6" >0.10</td>
            </tr>
            <tr>
                        <th id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14level0_row3" class="row_heading level0 row3" >3</th>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row3_col0" class="data row3 col0" >-0.70</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row3_col1" class="data row3 col1" >0.00</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row3_col2" class="data row3 col2" >-0.34</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row3_col3" class="data row3 col3" >-0.34</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row3_col4" class="data row3 col4" >-0.26</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row3_col5" class="data row3 col5" >-0.42</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row3_col6" class="data row3 col6" >-0.17</td>
            </tr>
            <tr>
                        <th id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14level0_row4" class="row_heading level0 row4" >4</th>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row4_col0" class="data row4 col0" >0.00</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row4_col1" class="data row4 col1" >-0.60</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row4_col2" class="data row4 col2" >0.64</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row4_col3" class="data row4 col3" >0.00</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row4_col4" class="data row4 col4" >0.00</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row4_col5" class="data row4 col5" >-0.44</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row4_col6" class="data row4 col6" >-0.18</td>
            </tr>
            <tr>
                        <th id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14level0_row5" class="row_heading level0 row5" >5</th>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row5_col0" class="data row5 col0" >0.00</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row5_col1" class="data row5 col1" >-0.75</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row5_col2" class="data row5 col2" >-0.44</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row5_col3" class="data row5 col3" >0.00</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row5_col4" class="data row5 col4" >0.00</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row5_col5" class="data row5 col5" >0.44</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row5_col6" class="data row5 col6" >-0.22</td>
            </tr>
            <tr>
                        <th id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14level0_row6" class="row_heading level0 row6" >6</th>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row6_col0" class="data row6 col0" >0.00</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row6_col1" class="data row6 col1" >-0.30</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row6_col2" class="data row6 col2" >-0.18</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row6_col3" class="data row6 col3" >0.00</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row6_col4" class="data row6 col4" >0.00</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row6_col5" class="data row6 col5" >-0.22</td>
                        <td id="T_d531ca2a_71ba_11ea_be1e_8c8590b50e14row6_col6" class="data row6 col6" >0.91</td>
            </tr>
    </tbody></table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style  type="text/css" >
    #T_d58130a6_71ba_11ea_be1e_8c8590b50e14row0_col0 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d58130a6_71ba_11ea_be1e_8c8590b50e14row1_col0 {
            background-color:  #056dab;
            color:  #f1f1f1;
        }    #T_d58130a6_71ba_11ea_be1e_8c8590b50e14row2_col0 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d58130a6_71ba_11ea_be1e_8c8590b50e14row3_col0 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d58130a6_71ba_11ea_be1e_8c8590b50e14row4_col0 {
            background-color:  #fff7fb;
            color:  #000000;
        }</style><table id="T_d58130a6_71ba_11ea_be1e_8c8590b50e14" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >0</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_d58130a6_71ba_11ea_be1e_8c8590b50e14level0_row0" class="row_heading level0 row0" >0</th>
                        <td id="T_d58130a6_71ba_11ea_be1e_8c8590b50e14row0_col0" class="data row0 col0" >12.37</td>
            </tr>
            <tr>
                        <th id="T_d58130a6_71ba_11ea_be1e_8c8590b50e14level0_row1" class="row_heading level0 row1" >1</th>
                        <td id="T_d58130a6_71ba_11ea_be1e_8c8590b50e14row1_col0" class="data row1 col0" >9.49</td>
            </tr>
            <tr>
                        <th id="T_d58130a6_71ba_11ea_be1e_8c8590b50e14level0_row2" class="row_heading level0 row2" >2</th>
                        <td id="T_d58130a6_71ba_11ea_be1e_8c8590b50e14row2_col0" class="data row2 col0" >0.00</td>
            </tr>
            <tr>
                        <th id="T_d58130a6_71ba_11ea_be1e_8c8590b50e14level0_row3" class="row_heading level0 row3" >3</th>
                        <td id="T_d58130a6_71ba_11ea_be1e_8c8590b50e14row3_col0" class="data row3 col0" >0.00</td>
            </tr>
            <tr>
                        <th id="T_d58130a6_71ba_11ea_be1e_8c8590b50e14level0_row4" class="row_heading level0 row4" >4</th>
                        <td id="T_d58130a6_71ba_11ea_be1e_8c8590b50e14row4_col0" class="data row4 col0" >0.00</td>
            </tr>
    </tbody></table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style  type="text/css" >
    #T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row0_col0 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row0_col1 {
            background-color:  #e0dded;
            color:  #000000;
        }    #T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row0_col2 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row0_col3 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row0_col4 {
            background-color:  #73a9cf;
            color:  #000000;
        }    #T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row1_col0 {
            background-color:  #96b6d7;
            color:  #000000;
        }    #T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row1_col1 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row1_col2 {
            background-color:  #88b1d4;
            color:  #000000;
        }    #T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row1_col3 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row1_col4 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row2_col0 {
            background-color:  #96b6d7;
            color:  #000000;
        }    #T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row2_col1 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row2_col2 {
            background-color:  #88b1d4;
            color:  #000000;
        }    #T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row2_col3 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row2_col4 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row3_col0 {
            background-color:  #96b6d7;
            color:  #000000;
        }    #T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row3_col1 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row3_col2 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row3_col3 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row3_col4 {
            background-color:  #73a9cf;
            color:  #000000;
        }    #T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row4_col0 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row4_col1 {
            background-color:  #93b5d6;
            color:  #000000;
        }    #T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row4_col2 {
            background-color:  #ebe6f2;
            color:  #000000;
        }    #T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row4_col3 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row4_col4 {
            background-color:  #73a9cf;
            color:  #000000;
        }</style><table id="T_d5cf3012_71ba_11ea_be1e_8c8590b50e14" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >0</th>        <th class="col_heading level0 col1" >1</th>        <th class="col_heading level0 col2" >2</th>        <th class="col_heading level0 col3" >3</th>        <th class="col_heading level0 col4" >4</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_d5cf3012_71ba_11ea_be1e_8c8590b50e14level0_row0" class="row_heading level0 row0" >0</th>
                        <td id="T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row0_col0" class="data row0 col0" >-0.58</td>
                        <td id="T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row0_col1" class="data row0 col1" >-0.58</td>
                        <td id="T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row0_col2" class="data row0 col2" >-0.58</td>
                        <td id="T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row0_col3" class="data row0 col3" >-0.00</td>
                        <td id="T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row0_col4" class="data row0 col4" >-0.00</td>
            </tr>
            <tr>
                        <th id="T_d5cf3012_71ba_11ea_be1e_8c8590b50e14level0_row1" class="row_heading level0 row1" >1</th>
                        <td id="T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row1_col0" class="data row1 col0" >-0.00</td>
                        <td id="T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row1_col1" class="data row1 col1" >-0.00</td>
                        <td id="T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row1_col2" class="data row1 col2" >-0.00</td>
                        <td id="T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row1_col3" class="data row1 col3" >-0.71</td>
                        <td id="T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row1_col4" class="data row1 col4" >-0.71</td>
            </tr>
            <tr>
                        <th id="T_d5cf3012_71ba_11ea_be1e_8c8590b50e14level0_row2" class="row_heading level0 row2" >2</th>
                        <td id="T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row2_col0" class="data row2 col0" >0.00</td>
                        <td id="T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row2_col1" class="data row2 col1" >0.00</td>
                        <td id="T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row2_col2" class="data row2 col2" >0.00</td>
                        <td id="T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row2_col3" class="data row2 col3" >-0.71</td>
                        <td id="T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row2_col4" class="data row2 col4" >0.71</td>
            </tr>
            <tr>
                        <th id="T_d5cf3012_71ba_11ea_be1e_8c8590b50e14level0_row3" class="row_heading level0 row3" >3</th>
                        <td id="T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row3_col0" class="data row3 col0" >0.00</td>
                        <td id="T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row3_col1" class="data row3 col1" >-0.71</td>
                        <td id="T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row3_col2" class="data row3 col2" >0.71</td>
                        <td id="T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row3_col3" class="data row3 col3" >0.00</td>
                        <td id="T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row3_col4" class="data row3 col4" >0.00</td>
            </tr>
            <tr>
                        <th id="T_d5cf3012_71ba_11ea_be1e_8c8590b50e14level0_row4" class="row_heading level0 row4" >4</th>
                        <td id="T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row4_col0" class="data row4 col0" >0.82</td>
                        <td id="T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row4_col1" class="data row4 col1" >-0.41</td>
                        <td id="T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row4_col2" class="data row4 col2" >-0.41</td>
                        <td id="T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row4_col3" class="data row4 col3" >0.00</td>
                        <td id="T_d5cf3012_71ba_11ea_be1e_8c8590b50e14row4_col4" class="data row4 col4" >0.00</td>
            </tr>
    </tbody></table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">U</span><span class="p">[:,:</span><span class="mi">2</span><span class="p">])</span>   <span class="c1"># User to concept similarity</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style  type="text/css" >
    #T_d6260b12_71ba_11ea_be1e_8c8590b50e14row0_col0 {
            background-color:  #0567a2;
            color:  #f1f1f1;
        }    #T_d6260b12_71ba_11ea_be1e_8c8590b50e14row0_col1 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d6260b12_71ba_11ea_be1e_8c8590b50e14row1_col0 {
            background-color:  #9cb9d9;
            color:  #000000;
        }    #T_d6260b12_71ba_11ea_be1e_8c8590b50e14row1_col1 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d6260b12_71ba_11ea_be1e_8c8590b50e14row2_col0 {
            background-color:  #dbdaeb;
            color:  #000000;
        }    #T_d6260b12_71ba_11ea_be1e_8c8590b50e14row2_col1 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d6260b12_71ba_11ea_be1e_8c8590b50e14row3_col0 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d6260b12_71ba_11ea_be1e_8c8590b50e14row3_col1 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d6260b12_71ba_11ea_be1e_8c8590b50e14row4_col0 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d6260b12_71ba_11ea_be1e_8c8590b50e14row4_col1 {
            background-color:  #dbdaeb;
            color:  #000000;
        }    #T_d6260b12_71ba_11ea_be1e_8c8590b50e14row5_col0 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d6260b12_71ba_11ea_be1e_8c8590b50e14row5_col1 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d6260b12_71ba_11ea_be1e_8c8590b50e14row6_col0 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d6260b12_71ba_11ea_be1e_8c8590b50e14row6_col1 {
            background-color:  #4295c3;
            color:  #000000;
        }</style><table id="T_d6260b12_71ba_11ea_be1e_8c8590b50e14" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >0</th>        <th class="col_heading level0 col1" >1</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_d6260b12_71ba_11ea_be1e_8c8590b50e14level0_row0" class="row_heading level0 row0" >0</th>
                        <td id="T_d6260b12_71ba_11ea_be1e_8c8590b50e14row0_col0" class="data row0 col0" >-0.14</td>
                        <td id="T_d6260b12_71ba_11ea_be1e_8c8590b50e14row0_col1" class="data row0 col1" >0.00</td>
            </tr>
            <tr>
                        <th id="T_d6260b12_71ba_11ea_be1e_8c8590b50e14level0_row1" class="row_heading level0 row1" >1</th>
                        <td id="T_d6260b12_71ba_11ea_be1e_8c8590b50e14row1_col0" class="data row1 col0" >-0.42</td>
                        <td id="T_d6260b12_71ba_11ea_be1e_8c8590b50e14row1_col1" class="data row1 col1" >0.00</td>
            </tr>
            <tr>
                        <th id="T_d6260b12_71ba_11ea_be1e_8c8590b50e14level0_row2" class="row_heading level0 row2" >2</th>
                        <td id="T_d6260b12_71ba_11ea_be1e_8c8590b50e14row2_col0" class="data row2 col0" >-0.56</td>
                        <td id="T_d6260b12_71ba_11ea_be1e_8c8590b50e14row2_col1" class="data row2 col1" >0.00</td>
            </tr>
            <tr>
                        <th id="T_d6260b12_71ba_11ea_be1e_8c8590b50e14level0_row3" class="row_heading level0 row3" >3</th>
                        <td id="T_d6260b12_71ba_11ea_be1e_8c8590b50e14row3_col0" class="data row3 col0" >-0.70</td>
                        <td id="T_d6260b12_71ba_11ea_be1e_8c8590b50e14row3_col1" class="data row3 col1" >0.00</td>
            </tr>
            <tr>
                        <th id="T_d6260b12_71ba_11ea_be1e_8c8590b50e14level0_row4" class="row_heading level0 row4" >4</th>
                        <td id="T_d6260b12_71ba_11ea_be1e_8c8590b50e14row4_col0" class="data row4 col0" >0.00</td>
                        <td id="T_d6260b12_71ba_11ea_be1e_8c8590b50e14row4_col1" class="data row4 col1" >-0.60</td>
            </tr>
            <tr>
                        <th id="T_d6260b12_71ba_11ea_be1e_8c8590b50e14level0_row5" class="row_heading level0 row5" >5</th>
                        <td id="T_d6260b12_71ba_11ea_be1e_8c8590b50e14row5_col0" class="data row5 col0" >0.00</td>
                        <td id="T_d6260b12_71ba_11ea_be1e_8c8590b50e14row5_col1" class="data row5 col1" >-0.75</td>
            </tr>
            <tr>
                        <th id="T_d6260b12_71ba_11ea_be1e_8c8590b50e14level0_row6" class="row_heading level0 row6" >6</th>
                        <td id="T_d6260b12_71ba_11ea_be1e_8c8590b50e14row6_col0" class="data row6 col0" >0.00</td>
                        <td id="T_d6260b12_71ba_11ea_be1e_8c8590b50e14row6_col1" class="data row6 col1" >-0.30</td>
            </tr>
    </tbody></table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">S</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span>      <span class="c1"># Concept strengths</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style  type="text/css" >
    #T_d6619b3c_71ba_11ea_be1e_8c8590b50e14row0_col0 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d6619b3c_71ba_11ea_be1e_8c8590b50e14row1_col0 {
            background-color:  #fff7fb;
            color:  #000000;
        }</style><table id="T_d6619b3c_71ba_11ea_be1e_8c8590b50e14" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >0</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_d6619b3c_71ba_11ea_be1e_8c8590b50e14level0_row0" class="row_heading level0 row0" >0</th>
                        <td id="T_d6619b3c_71ba_11ea_be1e_8c8590b50e14row0_col0" class="data row0 col0" >12.37</td>
            </tr>
            <tr>
                        <th id="T_d6619b3c_71ba_11ea_be1e_8c8590b50e14level0_row1" class="row_heading level0 row1" >1</th>
                        <td id="T_d6619b3c_71ba_11ea_be1e_8c8590b50e14row1_col0" class="data row1 col0" >9.49</td>
            </tr>
    </tbody></table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">V</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span>    <span class="c1"># Movie to concept similarity</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style  type="text/css" >
    #T_d6b5763a_71ba_11ea_be1e_8c8590b50e14row0_col0 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d6b5763a_71ba_11ea_be1e_8c8590b50e14row0_col1 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d6b5763a_71ba_11ea_be1e_8c8590b50e14row0_col2 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d6b5763a_71ba_11ea_be1e_8c8590b50e14row0_col3 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d6b5763a_71ba_11ea_be1e_8c8590b50e14row0_col4 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d6b5763a_71ba_11ea_be1e_8c8590b50e14row1_col0 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d6b5763a_71ba_11ea_be1e_8c8590b50e14row1_col1 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d6b5763a_71ba_11ea_be1e_8c8590b50e14row1_col2 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d6b5763a_71ba_11ea_be1e_8c8590b50e14row1_col3 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d6b5763a_71ba_11ea_be1e_8c8590b50e14row1_col4 {
            background-color:  #fff7fb;
            color:  #000000;
        }</style><table id="T_d6b5763a_71ba_11ea_be1e_8c8590b50e14" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >0</th>        <th class="col_heading level0 col1" >1</th>        <th class="col_heading level0 col2" >2</th>        <th class="col_heading level0 col3" >3</th>        <th class="col_heading level0 col4" >4</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_d6b5763a_71ba_11ea_be1e_8c8590b50e14level0_row0" class="row_heading level0 row0" >0</th>
                        <td id="T_d6b5763a_71ba_11ea_be1e_8c8590b50e14row0_col0" class="data row0 col0" >-0.58</td>
                        <td id="T_d6b5763a_71ba_11ea_be1e_8c8590b50e14row0_col1" class="data row0 col1" >-0.58</td>
                        <td id="T_d6b5763a_71ba_11ea_be1e_8c8590b50e14row0_col2" class="data row0 col2" >-0.58</td>
                        <td id="T_d6b5763a_71ba_11ea_be1e_8c8590b50e14row0_col3" class="data row0 col3" >-0.00</td>
                        <td id="T_d6b5763a_71ba_11ea_be1e_8c8590b50e14row0_col4" class="data row0 col4" >-0.00</td>
            </tr>
            <tr>
                        <th id="T_d6b5763a_71ba_11ea_be1e_8c8590b50e14level0_row1" class="row_heading level0 row1" >1</th>
                        <td id="T_d6b5763a_71ba_11ea_be1e_8c8590b50e14row1_col0" class="data row1 col0" >-0.00</td>
                        <td id="T_d6b5763a_71ba_11ea_be1e_8c8590b50e14row1_col1" class="data row1 col1" >-0.00</td>
                        <td id="T_d6b5763a_71ba_11ea_be1e_8c8590b50e14row1_col2" class="data row1 col2" >-0.00</td>
                        <td id="T_d6b5763a_71ba_11ea_be1e_8c8590b50e14row1_col3" class="data row1 col3" >-0.71</td>
                        <td id="T_d6b5763a_71ba_11ea_be1e_8c8590b50e14row1_col4" class="data row1 col4" >-0.71</td>
            </tr>
    </tbody></table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">((</span><span class="n">U</span><span class="p">[:,:</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">S</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">V</span><span class="p">[:</span><span class="mi">2</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style  type="text/css" >
    #T_d70638fe_71ba_11ea_be1e_8c8590b50e14row0_col0 {
            background-color:  #dbdaeb;
            color:  #000000;
        }    #T_d70638fe_71ba_11ea_be1e_8c8590b50e14row0_col1 {
            background-color:  #dbdaeb;
            color:  #000000;
        }    #T_d70638fe_71ba_11ea_be1e_8c8590b50e14row0_col2 {
            background-color:  #dbdaeb;
            color:  #000000;
        }    #T_d70638fe_71ba_11ea_be1e_8c8590b50e14row0_col3 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d70638fe_71ba_11ea_be1e_8c8590b50e14row0_col4 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d70638fe_71ba_11ea_be1e_8c8590b50e14row1_col0 {
            background-color:  #4295c3;
            color:  #000000;
        }    #T_d70638fe_71ba_11ea_be1e_8c8590b50e14row1_col1 {
            background-color:  #4295c3;
            color:  #000000;
        }    #T_d70638fe_71ba_11ea_be1e_8c8590b50e14row1_col2 {
            background-color:  #4295c3;
            color:  #000000;
        }    #T_d70638fe_71ba_11ea_be1e_8c8590b50e14row1_col3 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d70638fe_71ba_11ea_be1e_8c8590b50e14row1_col4 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d70638fe_71ba_11ea_be1e_8c8590b50e14row2_col0 {
            background-color:  #0567a2;
            color:  #f1f1f1;
        }    #T_d70638fe_71ba_11ea_be1e_8c8590b50e14row2_col1 {
            background-color:  #0567a2;
            color:  #f1f1f1;
        }    #T_d70638fe_71ba_11ea_be1e_8c8590b50e14row2_col2 {
            background-color:  #0567a2;
            color:  #f1f1f1;
        }    #T_d70638fe_71ba_11ea_be1e_8c8590b50e14row2_col3 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d70638fe_71ba_11ea_be1e_8c8590b50e14row2_col4 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d70638fe_71ba_11ea_be1e_8c8590b50e14row3_col0 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d70638fe_71ba_11ea_be1e_8c8590b50e14row3_col1 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d70638fe_71ba_11ea_be1e_8c8590b50e14row3_col2 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d70638fe_71ba_11ea_be1e_8c8590b50e14row3_col3 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d70638fe_71ba_11ea_be1e_8c8590b50e14row3_col4 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d70638fe_71ba_11ea_be1e_8c8590b50e14row4_col0 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d70638fe_71ba_11ea_be1e_8c8590b50e14row4_col1 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d70638fe_71ba_11ea_be1e_8c8590b50e14row4_col2 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d70638fe_71ba_11ea_be1e_8c8590b50e14row4_col3 {
            background-color:  #0567a2;
            color:  #f1f1f1;
        }    #T_d70638fe_71ba_11ea_be1e_8c8590b50e14row4_col4 {
            background-color:  #0567a2;
            color:  #f1f1f1;
        }    #T_d70638fe_71ba_11ea_be1e_8c8590b50e14row5_col0 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d70638fe_71ba_11ea_be1e_8c8590b50e14row5_col1 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d70638fe_71ba_11ea_be1e_8c8590b50e14row5_col2 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d70638fe_71ba_11ea_be1e_8c8590b50e14row5_col3 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d70638fe_71ba_11ea_be1e_8c8590b50e14row5_col4 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d70638fe_71ba_11ea_be1e_8c8590b50e14row6_col0 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d70638fe_71ba_11ea_be1e_8c8590b50e14row6_col1 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d70638fe_71ba_11ea_be1e_8c8590b50e14row6_col2 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d70638fe_71ba_11ea_be1e_8c8590b50e14row6_col3 {
            background-color:  #9cb9d9;
            color:  #000000;
        }    #T_d70638fe_71ba_11ea_be1e_8c8590b50e14row6_col4 {
            background-color:  #9cb9d9;
            color:  #000000;
        }</style><table id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >0</th>        <th class="col_heading level0 col1" >1</th>        <th class="col_heading level0 col2" >2</th>        <th class="col_heading level0 col3" >3</th>        <th class="col_heading level0 col4" >4</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14level0_row0" class="row_heading level0 row0" >0</th>
                        <td id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14row0_col0" class="data row0 col0" >1.00</td>
                        <td id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14row0_col1" class="data row0 col1" >1.00</td>
                        <td id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14row0_col2" class="data row0 col2" >1.00</td>
                        <td id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14row0_col3" class="data row0 col3" >0.00</td>
                        <td id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14row0_col4" class="data row0 col4" >0.00</td>
            </tr>
            <tr>
                        <th id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14level0_row1" class="row_heading level0 row1" >1</th>
                        <td id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14row1_col0" class="data row1 col0" >3.00</td>
                        <td id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14row1_col1" class="data row1 col1" >3.00</td>
                        <td id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14row1_col2" class="data row1 col2" >3.00</td>
                        <td id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14row1_col3" class="data row1 col3" >0.00</td>
                        <td id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14row1_col4" class="data row1 col4" >0.00</td>
            </tr>
            <tr>
                        <th id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14level0_row2" class="row_heading level0 row2" >2</th>
                        <td id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14row2_col0" class="data row2 col0" >4.00</td>
                        <td id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14row2_col1" class="data row2 col1" >4.00</td>
                        <td id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14row2_col2" class="data row2 col2" >4.00</td>
                        <td id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14row2_col3" class="data row2 col3" >0.00</td>
                        <td id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14row2_col4" class="data row2 col4" >0.00</td>
            </tr>
            <tr>
                        <th id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14level0_row3" class="row_heading level0 row3" >3</th>
                        <td id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14row3_col0" class="data row3 col0" >5.00</td>
                        <td id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14row3_col1" class="data row3 col1" >5.00</td>
                        <td id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14row3_col2" class="data row3 col2" >5.00</td>
                        <td id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14row3_col3" class="data row3 col3" >0.00</td>
                        <td id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14row3_col4" class="data row3 col4" >0.00</td>
            </tr>
            <tr>
                        <th id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14level0_row4" class="row_heading level0 row4" >4</th>
                        <td id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14row4_col0" class="data row4 col0" >0.00</td>
                        <td id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14row4_col1" class="data row4 col1" >0.00</td>
                        <td id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14row4_col2" class="data row4 col2" >0.00</td>
                        <td id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14row4_col3" class="data row4 col3" >4.00</td>
                        <td id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14row4_col4" class="data row4 col4" >4.00</td>
            </tr>
            <tr>
                        <th id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14level0_row5" class="row_heading level0 row5" >5</th>
                        <td id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14row5_col0" class="data row5 col0" >0.00</td>
                        <td id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14row5_col1" class="data row5 col1" >0.00</td>
                        <td id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14row5_col2" class="data row5 col2" >0.00</td>
                        <td id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14row5_col3" class="data row5 col3" >5.00</td>
                        <td id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14row5_col4" class="data row5 col4" >5.00</td>
            </tr>
            <tr>
                        <th id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14level0_row6" class="row_heading level0 row6" >6</th>
                        <td id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14row6_col0" class="data row6 col0" >0.00</td>
                        <td id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14row6_col1" class="data row6 col1" >0.00</td>
                        <td id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14row6_col2" class="data row6 col2" >0.00</td>
                        <td id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14row6_col3" class="data row6 col3" >2.00</td>
                        <td id="T_d70638fe_71ba_11ea_be1e_8c8590b50e14row6_col4" class="data row6 col4" >2.00</td>
            </tr>
    </tbody></table></div></div>
</div>
<p>What if we add some noise?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Matrix&#39;</span><span class="p">,</span> <span class="s1">&#39;Alien&#39;</span><span class="p">,</span> <span class="s1">&#39;Serenity&#39;</span><span class="p">,</span> <span class="s1">&#39;Casablanca&#39;</span><span class="p">,</span> <span class="s1">&#39;Amelie&#39;</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style  type="text/css" >
    #T_d798f810_71ba_11ea_be1e_8c8590b50e14row0_col0 {
            background-color:  #dbdaeb;
            color:  #000000;
        }    #T_d798f810_71ba_11ea_be1e_8c8590b50e14row0_col1 {
            background-color:  #dbdaeb;
            color:  #000000;
        }    #T_d798f810_71ba_11ea_be1e_8c8590b50e14row0_col2 {
            background-color:  #dbdaeb;
            color:  #000000;
        }    #T_d798f810_71ba_11ea_be1e_8c8590b50e14row0_col3 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d798f810_71ba_11ea_be1e_8c8590b50e14row0_col4 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d798f810_71ba_11ea_be1e_8c8590b50e14row1_col0 {
            background-color:  #4295c3;
            color:  #000000;
        }    #T_d798f810_71ba_11ea_be1e_8c8590b50e14row1_col1 {
            background-color:  #4295c3;
            color:  #000000;
        }    #T_d798f810_71ba_11ea_be1e_8c8590b50e14row1_col2 {
            background-color:  #4295c3;
            color:  #000000;
        }    #T_d798f810_71ba_11ea_be1e_8c8590b50e14row1_col3 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d798f810_71ba_11ea_be1e_8c8590b50e14row1_col4 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d798f810_71ba_11ea_be1e_8c8590b50e14row2_col0 {
            background-color:  #0567a2;
            color:  #f1f1f1;
        }    #T_d798f810_71ba_11ea_be1e_8c8590b50e14row2_col1 {
            background-color:  #0567a2;
            color:  #f1f1f1;
        }    #T_d798f810_71ba_11ea_be1e_8c8590b50e14row2_col2 {
            background-color:  #0567a2;
            color:  #f1f1f1;
        }    #T_d798f810_71ba_11ea_be1e_8c8590b50e14row2_col3 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d798f810_71ba_11ea_be1e_8c8590b50e14row2_col4 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d798f810_71ba_11ea_be1e_8c8590b50e14row3_col0 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d798f810_71ba_11ea_be1e_8c8590b50e14row3_col1 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d798f810_71ba_11ea_be1e_8c8590b50e14row3_col2 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d798f810_71ba_11ea_be1e_8c8590b50e14row3_col3 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d798f810_71ba_11ea_be1e_8c8590b50e14row3_col4 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d798f810_71ba_11ea_be1e_8c8590b50e14row4_col0 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d798f810_71ba_11ea_be1e_8c8590b50e14row4_col1 {
            background-color:  #9cb9d9;
            color:  #000000;
        }    #T_d798f810_71ba_11ea_be1e_8c8590b50e14row4_col2 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d798f810_71ba_11ea_be1e_8c8590b50e14row4_col3 {
            background-color:  #0567a2;
            color:  #f1f1f1;
        }    #T_d798f810_71ba_11ea_be1e_8c8590b50e14row4_col4 {
            background-color:  #0567a2;
            color:  #f1f1f1;
        }    #T_d798f810_71ba_11ea_be1e_8c8590b50e14row5_col0 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d798f810_71ba_11ea_be1e_8c8590b50e14row5_col1 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d798f810_71ba_11ea_be1e_8c8590b50e14row5_col2 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d798f810_71ba_11ea_be1e_8c8590b50e14row5_col3 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d798f810_71ba_11ea_be1e_8c8590b50e14row5_col4 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d798f810_71ba_11ea_be1e_8c8590b50e14row6_col0 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d798f810_71ba_11ea_be1e_8c8590b50e14row6_col1 {
            background-color:  #dbdaeb;
            color:  #000000;
        }    #T_d798f810_71ba_11ea_be1e_8c8590b50e14row6_col2 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d798f810_71ba_11ea_be1e_8c8590b50e14row6_col3 {
            background-color:  #9cb9d9;
            color:  #000000;
        }    #T_d798f810_71ba_11ea_be1e_8c8590b50e14row6_col4 {
            background-color:  #9cb9d9;
            color:  #000000;
        }</style><table id="T_d798f810_71ba_11ea_be1e_8c8590b50e14" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >Matrix</th>        <th class="col_heading level0 col1" >Alien</th>        <th class="col_heading level0 col2" >Serenity</th>        <th class="col_heading level0 col3" >Casablanca</th>        <th class="col_heading level0 col4" >Amelie</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_d798f810_71ba_11ea_be1e_8c8590b50e14level0_row0" class="row_heading level0 row0" >0</th>
                        <td id="T_d798f810_71ba_11ea_be1e_8c8590b50e14row0_col0" class="data row0 col0" >1.00</td>
                        <td id="T_d798f810_71ba_11ea_be1e_8c8590b50e14row0_col1" class="data row0 col1" >1.00</td>
                        <td id="T_d798f810_71ba_11ea_be1e_8c8590b50e14row0_col2" class="data row0 col2" >1.00</td>
                        <td id="T_d798f810_71ba_11ea_be1e_8c8590b50e14row0_col3" class="data row0 col3" >0.00</td>
                        <td id="T_d798f810_71ba_11ea_be1e_8c8590b50e14row0_col4" class="data row0 col4" >0.00</td>
            </tr>
            <tr>
                        <th id="T_d798f810_71ba_11ea_be1e_8c8590b50e14level0_row1" class="row_heading level0 row1" >1</th>
                        <td id="T_d798f810_71ba_11ea_be1e_8c8590b50e14row1_col0" class="data row1 col0" >3.00</td>
                        <td id="T_d798f810_71ba_11ea_be1e_8c8590b50e14row1_col1" class="data row1 col1" >3.00</td>
                        <td id="T_d798f810_71ba_11ea_be1e_8c8590b50e14row1_col2" class="data row1 col2" >3.00</td>
                        <td id="T_d798f810_71ba_11ea_be1e_8c8590b50e14row1_col3" class="data row1 col3" >0.00</td>
                        <td id="T_d798f810_71ba_11ea_be1e_8c8590b50e14row1_col4" class="data row1 col4" >0.00</td>
            </tr>
            <tr>
                        <th id="T_d798f810_71ba_11ea_be1e_8c8590b50e14level0_row2" class="row_heading level0 row2" >2</th>
                        <td id="T_d798f810_71ba_11ea_be1e_8c8590b50e14row2_col0" class="data row2 col0" >4.00</td>
                        <td id="T_d798f810_71ba_11ea_be1e_8c8590b50e14row2_col1" class="data row2 col1" >4.00</td>
                        <td id="T_d798f810_71ba_11ea_be1e_8c8590b50e14row2_col2" class="data row2 col2" >4.00</td>
                        <td id="T_d798f810_71ba_11ea_be1e_8c8590b50e14row2_col3" class="data row2 col3" >0.00</td>
                        <td id="T_d798f810_71ba_11ea_be1e_8c8590b50e14row2_col4" class="data row2 col4" >0.00</td>
            </tr>
            <tr>
                        <th id="T_d798f810_71ba_11ea_be1e_8c8590b50e14level0_row3" class="row_heading level0 row3" >3</th>
                        <td id="T_d798f810_71ba_11ea_be1e_8c8590b50e14row3_col0" class="data row3 col0" >5.00</td>
                        <td id="T_d798f810_71ba_11ea_be1e_8c8590b50e14row3_col1" class="data row3 col1" >5.00</td>
                        <td id="T_d798f810_71ba_11ea_be1e_8c8590b50e14row3_col2" class="data row3 col2" >5.00</td>
                        <td id="T_d798f810_71ba_11ea_be1e_8c8590b50e14row3_col3" class="data row3 col3" >0.00</td>
                        <td id="T_d798f810_71ba_11ea_be1e_8c8590b50e14row3_col4" class="data row3 col4" >0.00</td>
            </tr>
            <tr>
                        <th id="T_d798f810_71ba_11ea_be1e_8c8590b50e14level0_row4" class="row_heading level0 row4" >4</th>
                        <td id="T_d798f810_71ba_11ea_be1e_8c8590b50e14row4_col0" class="data row4 col0" >0.00</td>
                        <td id="T_d798f810_71ba_11ea_be1e_8c8590b50e14row4_col1" class="data row4 col1" >2.00</td>
                        <td id="T_d798f810_71ba_11ea_be1e_8c8590b50e14row4_col2" class="data row4 col2" >0.00</td>
                        <td id="T_d798f810_71ba_11ea_be1e_8c8590b50e14row4_col3" class="data row4 col3" >4.00</td>
                        <td id="T_d798f810_71ba_11ea_be1e_8c8590b50e14row4_col4" class="data row4 col4" >4.00</td>
            </tr>
            <tr>
                        <th id="T_d798f810_71ba_11ea_be1e_8c8590b50e14level0_row5" class="row_heading level0 row5" >5</th>
                        <td id="T_d798f810_71ba_11ea_be1e_8c8590b50e14row5_col0" class="data row5 col0" >0.00</td>
                        <td id="T_d798f810_71ba_11ea_be1e_8c8590b50e14row5_col1" class="data row5 col1" >0.00</td>
                        <td id="T_d798f810_71ba_11ea_be1e_8c8590b50e14row5_col2" class="data row5 col2" >0.00</td>
                        <td id="T_d798f810_71ba_11ea_be1e_8c8590b50e14row5_col3" class="data row5 col3" >5.00</td>
                        <td id="T_d798f810_71ba_11ea_be1e_8c8590b50e14row5_col4" class="data row5 col4" >5.00</td>
            </tr>
            <tr>
                        <th id="T_d798f810_71ba_11ea_be1e_8c8590b50e14level0_row6" class="row_heading level0 row6" >6</th>
                        <td id="T_d798f810_71ba_11ea_be1e_8c8590b50e14row6_col0" class="data row6 col0" >0.00</td>
                        <td id="T_d798f810_71ba_11ea_be1e_8c8590b50e14row6_col1" class="data row6 col1" >1.00</td>
                        <td id="T_d798f810_71ba_11ea_be1e_8c8590b50e14row6_col2" class="data row6 col2" >0.00</td>
                        <td id="T_d798f810_71ba_11ea_be1e_8c8590b50e14row6_col3" class="data row6 col3" >2.00</td>
                        <td id="T_d798f810_71ba_11ea_be1e_8c8590b50e14row6_col4" class="data row6 col4" >2.00</td>
            </tr>
    </tbody></table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">U</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">U</span><span class="p">[:,:</span><span class="mi">3</span><span class="p">])</span>   <span class="c1"># User to concept similarity</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style  type="text/css" >
    #T_d8472160_71ba_11ea_be1e_8c8590b50e14row0_col0 {
            background-color:  #045585;
            color:  #f1f1f1;
        }    #T_d8472160_71ba_11ea_be1e_8c8590b50e14row0_col1 {
            background-color:  #eee9f3;
            color:  #000000;
        }    #T_d8472160_71ba_11ea_be1e_8c8590b50e14row0_col2 {
            background-color:  #73a9cf;
            color:  #000000;
        }    #T_d8472160_71ba_11ea_be1e_8c8590b50e14row1_col0 {
            background-color:  #89b1d4;
            color:  #000000;
        }    #T_d8472160_71ba_11ea_be1e_8c8590b50e14row1_col1 {
            background-color:  #f7f0f7;
            color:  #000000;
        }    #T_d8472160_71ba_11ea_be1e_8c8590b50e14row1_col2 {
            background-color:  #79abd0;
            color:  #000000;
        }    #T_d8472160_71ba_11ea_be1e_8c8590b50e14row2_col0 {
            background-color:  #d6d6e9;
            color:  #000000;
        }    #T_d8472160_71ba_11ea_be1e_8c8590b50e14row2_col1 {
            background-color:  #fbf3f9;
            color:  #000000;
        }    #T_d8472160_71ba_11ea_be1e_8c8590b50e14row2_col2 {
            background-color:  #7dacd1;
            color:  #000000;
        }    #T_d8472160_71ba_11ea_be1e_8c8590b50e14row3_col0 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d8472160_71ba_11ea_be1e_8c8590b50e14row3_col1 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d8472160_71ba_11ea_be1e_8c8590b50e14row3_col2 {
            background-color:  #81aed2;
            color:  #000000;
        }    #T_d8472160_71ba_11ea_be1e_8c8590b50e14row4_col0 {
            background-color:  #045b8e;
            color:  #f1f1f1;
        }    #T_d8472160_71ba_11ea_be1e_8c8590b50e14row4_col1 {
            background-color:  #046198;
            color:  #f1f1f1;
        }    #T_d8472160_71ba_11ea_be1e_8c8590b50e14row4_col2 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d8472160_71ba_11ea_be1e_8c8590b50e14row5_col0 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d8472160_71ba_11ea_be1e_8c8590b50e14row5_col1 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d8472160_71ba_11ea_be1e_8c8590b50e14row5_col2 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d8472160_71ba_11ea_be1e_8c8590b50e14row6_col0 {
            background-color:  #02395a;
            color:  #f1f1f1;
        }    #T_d8472160_71ba_11ea_be1e_8c8590b50e14row6_col1 {
            background-color:  #79abd0;
            color:  #000000;
        }    #T_d8472160_71ba_11ea_be1e_8c8590b50e14row6_col2 {
            background-color:  #056fae;
            color:  #f1f1f1;
        }</style><table id="T_d8472160_71ba_11ea_be1e_8c8590b50e14" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >0</th>        <th class="col_heading level0 col1" >1</th>        <th class="col_heading level0 col2" >2</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_d8472160_71ba_11ea_be1e_8c8590b50e14level0_row0" class="row_heading level0 row0" >0</th>
                        <td id="T_d8472160_71ba_11ea_be1e_8c8590b50e14row0_col0" class="data row0 col0" >-0.14</td>
                        <td id="T_d8472160_71ba_11ea_be1e_8c8590b50e14row0_col1" class="data row0 col1" >-0.02</td>
                        <td id="T_d8472160_71ba_11ea_be1e_8c8590b50e14row0_col2" class="data row0 col2" >-0.01</td>
            </tr>
            <tr>
                        <th id="T_d8472160_71ba_11ea_be1e_8c8590b50e14level0_row1" class="row_heading level0 row1" >1</th>
                        <td id="T_d8472160_71ba_11ea_be1e_8c8590b50e14row1_col0" class="data row1 col0" >-0.41</td>
                        <td id="T_d8472160_71ba_11ea_be1e_8c8590b50e14row1_col1" class="data row1 col1" >-0.07</td>
                        <td id="T_d8472160_71ba_11ea_be1e_8c8590b50e14row1_col2" class="data row1 col2" >-0.03</td>
            </tr>
            <tr>
                        <th id="T_d8472160_71ba_11ea_be1e_8c8590b50e14level0_row2" class="row_heading level0 row2" >2</th>
                        <td id="T_d8472160_71ba_11ea_be1e_8c8590b50e14row2_col0" class="data row2 col0" >-0.55</td>
                        <td id="T_d8472160_71ba_11ea_be1e_8c8590b50e14row2_col1" class="data row2 col1" >-0.09</td>
                        <td id="T_d8472160_71ba_11ea_be1e_8c8590b50e14row2_col2" class="data row2 col2" >-0.04</td>
            </tr>
            <tr>
                        <th id="T_d8472160_71ba_11ea_be1e_8c8590b50e14level0_row3" class="row_heading level0 row3" >3</th>
                        <td id="T_d8472160_71ba_11ea_be1e_8c8590b50e14row3_col0" class="data row3 col0" >-0.69</td>
                        <td id="T_d8472160_71ba_11ea_be1e_8c8590b50e14row3_col1" class="data row3 col1" >-0.12</td>
                        <td id="T_d8472160_71ba_11ea_be1e_8c8590b50e14row3_col2" class="data row3 col2" >-0.05</td>
            </tr>
            <tr>
                        <th id="T_d8472160_71ba_11ea_be1e_8c8590b50e14level0_row4" class="row_heading level0 row4" >4</th>
                        <td id="T_d8472160_71ba_11ea_be1e_8c8590b50e14row4_col0" class="data row4 col0" >-0.15</td>
                        <td id="T_d8472160_71ba_11ea_be1e_8c8590b50e14row4_col1" class="data row4 col1" >0.59</td>
                        <td id="T_d8472160_71ba_11ea_be1e_8c8590b50e14row4_col2" class="data row4 col2" >0.65</td>
            </tr>
            <tr>
                        <th id="T_d8472160_71ba_11ea_be1e_8c8590b50e14level0_row5" class="row_heading level0 row5" >5</th>
                        <td id="T_d8472160_71ba_11ea_be1e_8c8590b50e14row5_col0" class="data row5 col0" >-0.07</td>
                        <td id="T_d8472160_71ba_11ea_be1e_8c8590b50e14row5_col1" class="data row5 col1" >0.73</td>
                        <td id="T_d8472160_71ba_11ea_be1e_8c8590b50e14row5_col2" class="data row5 col2" >-0.68</td>
            </tr>
            <tr>
                        <th id="T_d8472160_71ba_11ea_be1e_8c8590b50e14level0_row6" class="row_heading level0 row6" >6</th>
                        <td id="T_d8472160_71ba_11ea_be1e_8c8590b50e14row6_col0" class="data row6 col0" >-0.08</td>
                        <td id="T_d8472160_71ba_11ea_be1e_8c8590b50e14row6_col1" class="data row6 col1" >0.30</td>
                        <td id="T_d8472160_71ba_11ea_be1e_8c8590b50e14row6_col2" class="data row6 col2" >0.33</td>
            </tr>
    </tbody></table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">S</span><span class="p">[:</span><span class="mi">3</span><span class="p">])</span>      <span class="c1"># Concept strengths</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style  type="text/css" >
    #T_d896247c_71ba_11ea_be1e_8c8590b50e14row0_col0 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d896247c_71ba_11ea_be1e_8c8590b50e14row1_col0 {
            background-color:  #0c74b2;
            color:  #f1f1f1;
        }    #T_d896247c_71ba_11ea_be1e_8c8590b50e14row2_col0 {
            background-color:  #fff7fb;
            color:  #000000;
        }</style><table id="T_d896247c_71ba_11ea_be1e_8c8590b50e14" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >0</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_d896247c_71ba_11ea_be1e_8c8590b50e14level0_row0" class="row_heading level0 row0" >0</th>
                        <td id="T_d896247c_71ba_11ea_be1e_8c8590b50e14row0_col0" class="data row0 col0" >12.48</td>
            </tr>
            <tr>
                        <th id="T_d896247c_71ba_11ea_be1e_8c8590b50e14level0_row1" class="row_heading level0 row1" >1</th>
                        <td id="T_d896247c_71ba_11ea_be1e_8c8590b50e14row1_col0" class="data row1 col0" >9.51</td>
            </tr>
            <tr>
                        <th id="T_d896247c_71ba_11ea_be1e_8c8590b50e14level0_row2" class="row_heading level0 row2" >2</th>
                        <td id="T_d896247c_71ba_11ea_be1e_8c8590b50e14row2_col0" class="data row2 col0" >1.35</td>
            </tr>
    </tbody></table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">V</span><span class="p">[:</span><span class="mi">3</span><span class="p">])</span>    <span class="c1"># Movie to concept similarity</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style  type="text/css" >
    #T_d8d82e44_71ba_11ea_be1e_8c8590b50e14row0_col0 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d8d82e44_71ba_11ea_be1e_8c8590b50e14row0_col1 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d8d82e44_71ba_11ea_be1e_8c8590b50e14row0_col2 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d8d82e44_71ba_11ea_be1e_8c8590b50e14row0_col3 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d8d82e44_71ba_11ea_be1e_8c8590b50e14row0_col4 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d8d82e44_71ba_11ea_be1e_8c8590b50e14row1_col0 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d8d82e44_71ba_11ea_be1e_8c8590b50e14row1_col1 {
            background-color:  #8bb2d4;
            color:  #000000;
        }    #T_d8d82e44_71ba_11ea_be1e_8c8590b50e14row1_col2 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d8d82e44_71ba_11ea_be1e_8c8590b50e14row1_col3 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d8d82e44_71ba_11ea_be1e_8c8590b50e14row1_col4 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d8d82e44_71ba_11ea_be1e_8c8590b50e14row2_col0 {
            background-color:  #afc1dd;
            color:  #000000;
        }    #T_d8d82e44_71ba_11ea_be1e_8c8590b50e14row2_col1 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d8d82e44_71ba_11ea_be1e_8c8590b50e14row2_col2 {
            background-color:  #afc1dd;
            color:  #000000;
        }    #T_d8d82e44_71ba_11ea_be1e_8c8590b50e14row2_col3 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d8d82e44_71ba_11ea_be1e_8c8590b50e14row2_col4 {
            background-color:  #fff7fb;
            color:  #000000;
        }</style><table id="T_d8d82e44_71ba_11ea_be1e_8c8590b50e14" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >0</th>        <th class="col_heading level0 col1" >1</th>        <th class="col_heading level0 col2" >2</th>        <th class="col_heading level0 col3" >3</th>        <th class="col_heading level0 col4" >4</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_d8d82e44_71ba_11ea_be1e_8c8590b50e14level0_row0" class="row_heading level0 row0" >0</th>
                        <td id="T_d8d82e44_71ba_11ea_be1e_8c8590b50e14row0_col0" class="data row0 col0" >-0.56</td>
                        <td id="T_d8d82e44_71ba_11ea_be1e_8c8590b50e14row0_col1" class="data row0 col1" >-0.59</td>
                        <td id="T_d8d82e44_71ba_11ea_be1e_8c8590b50e14row0_col2" class="data row0 col2" >-0.56</td>
                        <td id="T_d8d82e44_71ba_11ea_be1e_8c8590b50e14row0_col3" class="data row0 col3" >-0.09</td>
                        <td id="T_d8d82e44_71ba_11ea_be1e_8c8590b50e14row0_col4" class="data row0 col4" >-0.09</td>
            </tr>
            <tr>
                        <th id="T_d8d82e44_71ba_11ea_be1e_8c8590b50e14level0_row1" class="row_heading level0 row1" >1</th>
                        <td id="T_d8d82e44_71ba_11ea_be1e_8c8590b50e14row1_col0" class="data row1 col0" >-0.13</td>
                        <td id="T_d8d82e44_71ba_11ea_be1e_8c8590b50e14row1_col1" class="data row1 col1" >0.03</td>
                        <td id="T_d8d82e44_71ba_11ea_be1e_8c8590b50e14row1_col2" class="data row1 col2" >-0.13</td>
                        <td id="T_d8d82e44_71ba_11ea_be1e_8c8590b50e14row1_col3" class="data row1 col3" >0.70</td>
                        <td id="T_d8d82e44_71ba_11ea_be1e_8c8590b50e14row1_col4" class="data row1 col4" >0.70</td>
            </tr>
            <tr>
                        <th id="T_d8d82e44_71ba_11ea_be1e_8c8590b50e14level0_row2" class="row_heading level0 row2" >2</th>
                        <td id="T_d8d82e44_71ba_11ea_be1e_8c8590b50e14row2_col0" class="data row2 col0" >-0.41</td>
                        <td id="T_d8d82e44_71ba_11ea_be1e_8c8590b50e14row2_col1" class="data row2 col1" >0.80</td>
                        <td id="T_d8d82e44_71ba_11ea_be1e_8c8590b50e14row2_col2" class="data row2 col2" >-0.41</td>
                        <td id="T_d8d82e44_71ba_11ea_be1e_8c8590b50e14row2_col3" class="data row2 col3" >-0.09</td>
                        <td id="T_d8d82e44_71ba_11ea_be1e_8c8590b50e14row2_col4" class="data row2 col4" >-0.09</td>
            </tr>
    </tbody></table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">((</span><span class="n">U</span><span class="p">[:,:</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="n">S</span><span class="p">[:</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">V</span><span class="p">[:</span><span class="mi">3</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style  type="text/css" >
    #T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row0_col0 {
            background-color:  #dbdaeb;
            color:  #000000;
        }    #T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row0_col1 {
            background-color:  #dbdaeb;
            color:  #000000;
        }    #T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row0_col2 {
            background-color:  #dbdaeb;
            color:  #000000;
        }    #T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row0_col3 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row0_col4 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row1_col0 {
            background-color:  #4295c3;
            color:  #000000;
        }    #T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row1_col1 {
            background-color:  #4295c3;
            color:  #000000;
        }    #T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row1_col2 {
            background-color:  #4295c3;
            color:  #000000;
        }    #T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row1_col3 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row1_col4 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row2_col0 {
            background-color:  #0567a2;
            color:  #f1f1f1;
        }    #T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row2_col1 {
            background-color:  #0567a2;
            color:  #f1f1f1;
        }    #T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row2_col2 {
            background-color:  #0567a2;
            color:  #f1f1f1;
        }    #T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row2_col3 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row2_col4 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row3_col0 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row3_col1 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row3_col2 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row3_col3 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row3_col4 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row4_col0 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row4_col1 {
            background-color:  #9cb9d9;
            color:  #000000;
        }    #T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row4_col2 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row4_col3 {
            background-color:  #0567a2;
            color:  #f1f1f1;
        }    #T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row4_col4 {
            background-color:  #0567a2;
            color:  #f1f1f1;
        }    #T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row5_col0 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row5_col1 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row5_col2 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row5_col3 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row5_col4 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row6_col0 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row6_col1 {
            background-color:  #dbdaeb;
            color:  #000000;
        }    #T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row6_col2 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row6_col3 {
            background-color:  #9cb9d9;
            color:  #000000;
        }    #T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row6_col4 {
            background-color:  #9cb9d9;
            color:  #000000;
        }</style><table id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >0</th>        <th class="col_heading level0 col1" >1</th>        <th class="col_heading level0 col2" >2</th>        <th class="col_heading level0 col3" >3</th>        <th class="col_heading level0 col4" >4</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14level0_row0" class="row_heading level0 row0" >0</th>
                        <td id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row0_col0" class="data row0 col0" >1.00</td>
                        <td id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row0_col1" class="data row0 col1" >1.00</td>
                        <td id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row0_col2" class="data row0 col2" >1.00</td>
                        <td id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row0_col3" class="data row0 col3" >-0.00</td>
                        <td id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row0_col4" class="data row0 col4" >-0.00</td>
            </tr>
            <tr>
                        <th id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14level0_row1" class="row_heading level0 row1" >1</th>
                        <td id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row1_col0" class="data row1 col0" >3.00</td>
                        <td id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row1_col1" class="data row1 col1" >3.00</td>
                        <td id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row1_col2" class="data row1 col2" >3.00</td>
                        <td id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row1_col3" class="data row1 col3" >-0.00</td>
                        <td id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row1_col4" class="data row1 col4" >-0.00</td>
            </tr>
            <tr>
                        <th id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14level0_row2" class="row_heading level0 row2" >2</th>
                        <td id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row2_col0" class="data row2 col0" >4.00</td>
                        <td id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row2_col1" class="data row2 col1" >4.00</td>
                        <td id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row2_col2" class="data row2 col2" >4.00</td>
                        <td id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row2_col3" class="data row2 col3" >-0.00</td>
                        <td id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row2_col4" class="data row2 col4" >-0.00</td>
            </tr>
            <tr>
                        <th id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14level0_row3" class="row_heading level0 row3" >3</th>
                        <td id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row3_col0" class="data row3 col0" >5.00</td>
                        <td id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row3_col1" class="data row3 col1" >5.00</td>
                        <td id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row3_col2" class="data row3 col2" >5.00</td>
                        <td id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row3_col3" class="data row3 col3" >-0.00</td>
                        <td id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row3_col4" class="data row3 col4" >-0.00</td>
            </tr>
            <tr>
                        <th id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14level0_row4" class="row_heading level0 row4" >4</th>
                        <td id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row4_col0" class="data row4 col0" >-0.00</td>
                        <td id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row4_col1" class="data row4 col1" >2.00</td>
                        <td id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row4_col2" class="data row4 col2" >-0.00</td>
                        <td id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row4_col3" class="data row4 col3" >4.00</td>
                        <td id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row4_col4" class="data row4 col4" >4.00</td>
            </tr>
            <tr>
                        <th id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14level0_row5" class="row_heading level0 row5" >5</th>
                        <td id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row5_col0" class="data row5 col0" >-0.00</td>
                        <td id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row5_col1" class="data row5 col1" >0.00</td>
                        <td id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row5_col2" class="data row5 col2" >-0.00</td>
                        <td id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row5_col3" class="data row5 col3" >5.00</td>
                        <td id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row5_col4" class="data row5 col4" >5.00</td>
            </tr>
            <tr>
                        <th id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14level0_row6" class="row_heading level0 row6" >6</th>
                        <td id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row6_col0" class="data row6 col0" >-0.00</td>
                        <td id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row6_col1" class="data row6 col1" >1.00</td>
                        <td id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row6_col2" class="data row6 col2" >-0.00</td>
                        <td id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row6_col3" class="data row6 col3" >2.00</td>
                        <td id="T_d92a3fae_71ba_11ea_be1e_8c8590b50e14row6_col4" class="data row6 col4" >2.00</td>
            </tr>
    </tbody></table></div></div>
</div>
<p>Or an approximation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">((</span><span class="n">U</span><span class="p">[:,:</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">S</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">V</span><span class="p">[:</span><span class="mi">2</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style  type="text/css" >
    #T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row0_col0 {
            background-color:  #ced0e6;
            color:  #000000;
        }    #T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row0_col1 {
            background-color:  #f2ecf5;
            color:  #000000;
        }    #T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row0_col2 {
            background-color:  #ced0e6;
            color:  #000000;
        }    #T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row0_col3 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row0_col4 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row1_col0 {
            background-color:  #358fc0;
            color:  #000000;
        }    #T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row1_col1 {
            background-color:  #60a1ca;
            color:  #000000;
        }    #T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row1_col2 {
            background-color:  #358fc0;
            color:  #000000;
        }    #T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row1_col3 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row1_col4 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row2_col0 {
            background-color:  #04649e;
            color:  #f1f1f1;
        }    #T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row2_col1 {
            background-color:  #056caa;
            color:  #f1f1f1;
        }    #T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row2_col2 {
            background-color:  #04649e;
            color:  #f1f1f1;
        }    #T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row2_col3 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row2_col4 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row3_col0 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row3_col1 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row3_col2 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row3_col3 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row3_col4 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row4_col0 {
            background-color:  #e9e5f1;
            color:  #000000;
        }    #T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row4_col1 {
            background-color:  #e7e3f0;
            color:  #000000;
        }    #T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row4_col2 {
            background-color:  #e9e5f1;
            color:  #000000;
        }    #T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row4_col3 {
            background-color:  #046299;
            color:  #f1f1f1;
        }    #T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row4_col4 {
            background-color:  #046299;
            color:  #f1f1f1;
        }    #T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row5_col0 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row5_col1 {
            background-color:  #fcf4fa;
            color:  #000000;
        }    #T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row5_col2 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row5_col3 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row5_col4 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row6_col0 {
            background-color:  #f0eaf4;
            color:  #000000;
        }    #T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row6_col1 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row6_col2 {
            background-color:  #f0eaf4;
            color:  #000000;
        }    #T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row6_col3 {
            background-color:  #96b6d7;
            color:  #000000;
        }    #T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row6_col4 {
            background-color:  #96b6d7;
            color:  #000000;
        }</style><table id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >0</th>        <th class="col_heading level0 col1" >1</th>        <th class="col_heading level0 col2" >2</th>        <th class="col_heading level0 col3" >3</th>        <th class="col_heading level0 col4" >4</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14level0_row0" class="row_heading level0 row0" >0</th>
                        <td id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row0_col0" class="data row0 col0" >0.99</td>
                        <td id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row0_col1" class="data row0 col1" >1.01</td>
                        <td id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row0_col2" class="data row0 col2" >0.99</td>
                        <td id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row0_col3" class="data row0 col3" >-0.00</td>
                        <td id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row0_col4" class="data row0 col4" >-0.00</td>
            </tr>
            <tr>
                        <th id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14level0_row1" class="row_heading level0 row1" >1</th>
                        <td id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row1_col0" class="data row1 col0" >2.98</td>
                        <td id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row1_col1" class="data row1 col1" >3.04</td>
                        <td id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row1_col2" class="data row1 col2" >2.98</td>
                        <td id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row1_col3" class="data row1 col3" >-0.00</td>
                        <td id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row1_col4" class="data row1 col4" >-0.00</td>
            </tr>
            <tr>
                        <th id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14level0_row2" class="row_heading level0 row2" >2</th>
                        <td id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row2_col0" class="data row2 col0" >3.98</td>
                        <td id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row2_col1" class="data row2 col1" >4.05</td>
                        <td id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row2_col2" class="data row2 col2" >3.98</td>
                        <td id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row2_col3" class="data row2 col3" >-0.01</td>
                        <td id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row2_col4" class="data row2 col4" >-0.01</td>
            </tr>
            <tr>
                        <th id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14level0_row3" class="row_heading level0 row3" >3</th>
                        <td id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row3_col0" class="data row3 col0" >4.97</td>
                        <td id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row3_col1" class="data row3 col1" >5.06</td>
                        <td id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row3_col2" class="data row3 col2" >4.97</td>
                        <td id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row3_col3" class="data row3 col3" >-0.01</td>
                        <td id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row3_col4" class="data row3 col4" >-0.01</td>
            </tr>
            <tr>
                        <th id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14level0_row4" class="row_heading level0 row4" >4</th>
                        <td id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row4_col0" class="data row4 col0" >0.36</td>
                        <td id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row4_col1" class="data row4 col1" >1.29</td>
                        <td id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row4_col2" class="data row4 col2" >0.36</td>
                        <td id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row4_col3" class="data row4 col3" >4.08</td>
                        <td id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row4_col4" class="data row4 col4" >4.08</td>
            </tr>
            <tr>
                        <th id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14level0_row5" class="row_heading level0 row5" >5</th>
                        <td id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row5_col0" class="data row5 col0" >-0.37</td>
                        <td id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row5_col1" class="data row5 col1" >0.73</td>
                        <td id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row5_col2" class="data row5 col2" >-0.37</td>
                        <td id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row5_col3" class="data row5 col3" >4.92</td>
                        <td id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row5_col4" class="data row5 col4" >4.92</td>
            </tr>
            <tr>
                        <th id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14level0_row6" class="row_heading level0 row6" >6</th>
                        <td id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row6_col0" class="data row6 col0" >0.18</td>
                        <td id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row6_col1" class="data row6 col1" >0.65</td>
                        <td id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row6_col2" class="data row6 col2" >0.18</td>
                        <td id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row6_col3" class="data row6 col3" >2.04</td>
                        <td id="T_e4035c3a_71ba_11ea_be1e_8c8590b50e14row6_col4" class="data row6 col4" >2.04</td>
            </tr>
    </tbody></table></div></div>
</div>
<div class="section" id="simplest-recommender">
<h3>Simplest recommender<a class="headerlink" href="#simplest-recommender" title="Permalink to this headline">¶</a></h3>
<p>Let’s add some missing ratings into the mix.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Matrix&#39;</span><span class="p">,</span> <span class="s1">&#39;Alien&#39;</span><span class="p">,</span> <span class="s1">&#39;Serenity&#39;</span><span class="p">,</span> <span class="s1">&#39;Casablanca&#39;</span><span class="p">,</span> <span class="s1">&#39;Amelie&#39;</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style  type="text/css" >
    #T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row0_col0 {
            background-color:  #dbdaeb;
            color:  #000000;
        }    #T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row0_col1 {
            background-color:  #dbdaeb;
            color:  #000000;
        }    #T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row0_col2 {
            background-color:  #dbdaeb;
            color:  #000000;
        }    #T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row0_col3 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row0_col4 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row1_col0 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row1_col1 {
            background-color:  #4295c3;
            color:  #000000;
        }    #T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row1_col2 {
            background-color:  #4295c3;
            color:  #000000;
        }    #T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row1_col3 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row1_col4 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row2_col0 {
            background-color:  #0567a2;
            color:  #f1f1f1;
        }    #T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row2_col1 {
            background-color:  #0567a2;
            color:  #f1f1f1;
        }    #T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row2_col2 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row2_col3 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row2_col4 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row3_col0 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row3_col1 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row3_col2 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row3_col3 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row3_col4 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row4_col0 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row4_col1 {
            background-color:  #9cb9d9;
            color:  #000000;
        }    #T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row4_col2 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row4_col3 {
            background-color:  #0567a2;
            color:  #f1f1f1;
        }    #T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row4_col4 {
            background-color:  #0567a2;
            color:  #f1f1f1;
        }    #T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row5_col0 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row5_col1 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row5_col2 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row5_col3 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row5_col4 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row6_col0 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row6_col1 {
            background-color:  #dbdaeb;
            color:  #000000;
        }    #T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row6_col2 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row6_col3 {
            background-color:  #9cb9d9;
            color:  #000000;
        }    #T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row6_col4 {
            background-color:  #9cb9d9;
            color:  #000000;
        }</style><table id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >Matrix</th>        <th class="col_heading level0 col1" >Alien</th>        <th class="col_heading level0 col2" >Serenity</th>        <th class="col_heading level0 col3" >Casablanca</th>        <th class="col_heading level0 col4" >Amelie</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14level0_row0" class="row_heading level0 row0" >0</th>
                        <td id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row0_col0" class="data row0 col0" >1.00</td>
                        <td id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row0_col1" class="data row0 col1" >1.00</td>
                        <td id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row0_col2" class="data row0 col2" >1.00</td>
                        <td id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row0_col3" class="data row0 col3" >0.00</td>
                        <td id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row0_col4" class="data row0 col4" >0.00</td>
            </tr>
            <tr>
                        <th id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14level0_row1" class="row_heading level0 row1" >1</th>
                        <td id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row1_col0" class="data row1 col0" >0.00</td>
                        <td id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row1_col1" class="data row1 col1" >3.00</td>
                        <td id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row1_col2" class="data row1 col2" >3.00</td>
                        <td id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row1_col3" class="data row1 col3" >0.00</td>
                        <td id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row1_col4" class="data row1 col4" >0.00</td>
            </tr>
            <tr>
                        <th id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14level0_row2" class="row_heading level0 row2" >2</th>
                        <td id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row2_col0" class="data row2 col0" >4.00</td>
                        <td id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row2_col1" class="data row2 col1" >4.00</td>
                        <td id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row2_col2" class="data row2 col2" >0.00</td>
                        <td id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row2_col3" class="data row2 col3" >0.00</td>
                        <td id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row2_col4" class="data row2 col4" >0.00</td>
            </tr>
            <tr>
                        <th id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14level0_row3" class="row_heading level0 row3" >3</th>
                        <td id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row3_col0" class="data row3 col0" >5.00</td>
                        <td id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row3_col1" class="data row3 col1" >5.00</td>
                        <td id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row3_col2" class="data row3 col2" >5.00</td>
                        <td id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row3_col3" class="data row3 col3" >0.00</td>
                        <td id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row3_col4" class="data row3 col4" >0.00</td>
            </tr>
            <tr>
                        <th id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14level0_row4" class="row_heading level0 row4" >4</th>
                        <td id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row4_col0" class="data row4 col0" >0.00</td>
                        <td id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row4_col1" class="data row4 col1" >2.00</td>
                        <td id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row4_col2" class="data row4 col2" >0.00</td>
                        <td id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row4_col3" class="data row4 col3" >4.00</td>
                        <td id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row4_col4" class="data row4 col4" >4.00</td>
            </tr>
            <tr>
                        <th id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14level0_row5" class="row_heading level0 row5" >5</th>
                        <td id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row5_col0" class="data row5 col0" >0.00</td>
                        <td id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row5_col1" class="data row5 col1" >0.00</td>
                        <td id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row5_col2" class="data row5 col2" >0.00</td>
                        <td id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row5_col3" class="data row5 col3" >5.00</td>
                        <td id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row5_col4" class="data row5 col4" >5.00</td>
            </tr>
            <tr>
                        <th id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14level0_row6" class="row_heading level0 row6" >6</th>
                        <td id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row6_col0" class="data row6 col0" >0.00</td>
                        <td id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row6_col1" class="data row6 col1" >1.00</td>
                        <td id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row6_col2" class="data row6 col2" >0.00</td>
                        <td id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row6_col3" class="data row6 col3" >2.00</td>
                        <td id="T_e5a46e44_71ba_11ea_be1e_8c8590b50e14row6_col4" class="data row6 col4" >2.00</td>
            </tr>
    </tbody></table></div></div>
</div>
<p>Trick is that SVD will tend to ignore/remove some of these ‘mistakes’ and end up inputing missing ratings!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">U</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">display</span><span class="p">((</span><span class="n">U</span><span class="p">[:,:</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">S</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">V</span><span class="p">[:</span><span class="mi">2</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style  type="text/css" >
    #T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row0_col0 {
            background-color:  #cccfe5;
            color:  #000000;
        }    #T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row0_col1 {
            background-color:  #f0eaf4;
            color:  #000000;
        }    #T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row0_col2 {
            background-color:  #cacee5;
            color:  #000000;
        }    #T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row0_col3 {
            background-color:  #fdf5fa;
            color:  #000000;
        }    #T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row0_col4 {
            background-color:  #fdf5fa;
            color:  #000000;
        }    #T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row1_col0 {
            background-color:  #88b1d4;
            color:  #000000;
        }    #T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row1_col1 {
            background-color:  #b5c4df;
            color:  #000000;
        }    #T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row1_col2 {
            background-color:  #88b1d4;
            color:  #000000;
        }    #T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row1_col3 {
            background-color:  #faf3f9;
            color:  #000000;
        }    #T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row1_col4 {
            background-color:  #faf3f9;
            color:  #000000;
        }    #T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row2_col0 {
            background-color:  #3f93c2;
            color:  #000000;
        }    #T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row2_col1 {
            background-color:  #67a4cc;
            color:  #000000;
        }    #T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row2_col2 {
            background-color:  #3f93c2;
            color:  #000000;
        }    #T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row2_col3 {
            background-color:  #faf3f9;
            color:  #000000;
        }    #T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row2_col4 {
            background-color:  #faf3f9;
            color:  #000000;
        }    #T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row3_col0 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row3_col1 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row3_col2 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row3_col3 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row3_col4 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row4_col0 {
            background-color:  #e5e1ef;
            color:  #000000;
        }    #T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row4_col1 {
            background-color:  #e6e2ef;
            color:  #000000;
        }    #T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row4_col2 {
            background-color:  #e5e1ef;
            color:  #000000;
        }    #T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row4_col3 {
            background-color:  #046299;
            color:  #f1f1f1;
        }    #T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row4_col4 {
            background-color:  #046299;
            color:  #f1f1f1;
        }    #T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row5_col0 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row5_col1 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row5_col2 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row5_col3 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row5_col4 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row6_col0 {
            background-color:  #ede8f3;
            color:  #000000;
        }    #T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row6_col1 {
            background-color:  #fdf5fa;
            color:  #000000;
        }    #T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row6_col2 {
            background-color:  #ede8f3;
            color:  #000000;
        }    #T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row6_col3 {
            background-color:  #93b5d6;
            color:  #000000;
        }    #T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row6_col4 {
            background-color:  #93b5d6;
            color:  #000000;
        }</style><table id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >0</th>        <th class="col_heading level0 col1" >1</th>        <th class="col_heading level0 col2" >2</th>        <th class="col_heading level0 col3" >3</th>        <th class="col_heading level0 col4" >4</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14level0_row0" class="row_heading level0 row0" >0</th>
                        <td id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row0_col0" class="data row0 col0" >0.97</td>
                        <td id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row0_col1" class="data row0 col1" >1.15</td>
                        <td id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row0_col2" class="data row0 col2" >0.83</td>
                        <td id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row0_col3" class="data row0 col3" >-0.02</td>
                        <td id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row0_col4" class="data row0 col4" >-0.02</td>
            </tr>
            <tr>
                        <th id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14level0_row1" class="row_heading level0 row1" >1</th>
                        <td id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row1_col0" class="data row1 col0" >1.94</td>
                        <td id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row1_col1" class="data row1 col1" >2.33</td>
                        <td id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row1_col2" class="data row1 col2" >1.66</td>
                        <td id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row1_col3" class="data row1 col3" >0.08</td>
                        <td id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row1_col4" class="data row1 col4" >0.08</td>
            </tr>
            <tr>
                        <th id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14level0_row2" class="row_heading level0 row2" >2</th>
                        <td id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row2_col0" class="data row2 col0" >2.78</td>
                        <td id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row2_col1" class="data row2 col1" >3.32</td>
                        <td id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row2_col2" class="data row2 col2" >2.37</td>
                        <td id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row2_col3" class="data row2 col3" >0.08</td>
                        <td id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row2_col4" class="data row2 col4" >0.08</td>
            </tr>
            <tr>
                        <th id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14level0_row3" class="row_heading level0 row3" >3</th>
                        <td id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row3_col0" class="data row3 col0" >4.85</td>
                        <td id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row3_col1" class="data row3 col1" >5.74</td>
                        <td id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row3_col2" class="data row3 col2" >4.14</td>
                        <td id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row3_col3" class="data row3 col3" >-0.09</td>
                        <td id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row3_col4" class="data row3 col4" >-0.09</td>
            </tr>
            <tr>
                        <th id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14level0_row4" class="row_heading level0 row4" >4</th>
                        <td id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row4_col0" class="data row4 col0" >0.40</td>
                        <td id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row4_col1" class="data row4 col1" >1.42</td>
                        <td id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row4_col2" class="data row4 col2" >0.33</td>
                        <td id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row4_col3" class="data row4 col3" >4.07</td>
                        <td id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row4_col4" class="data row4 col4" >4.07</td>
            </tr>
            <tr>
                        <th id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14level0_row5" class="row_heading level0 row5" >5</th>
                        <td id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row5_col0" class="data row5 col0" >-0.43</td>
                        <td id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row5_col1" class="data row5 col1" >0.63</td>
                        <td id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row5_col2" class="data row5 col2" >-0.38</td>
                        <td id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row5_col3" class="data row5 col3" >4.93</td>
                        <td id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row5_col4" class="data row5 col4" >4.93</td>
            </tr>
            <tr>
                        <th id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14level0_row6" class="row_heading level0 row6" >6</th>
                        <td id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row6_col0" class="data row6 col0" >0.20</td>
                        <td id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row6_col1" class="data row6 col1" >0.71</td>
                        <td id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row6_col2" class="data row6 col2" >0.17</td>
                        <td id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row6_col3" class="data row6 col3" >2.03</td>
                        <td id="T_e6086ff2_71ba_11ea_be1e_8c8590b50e14row6_col4" class="data row6 col4" >2.03</td>
            </tr>
    </tbody></table></div></div>
</div>
</div>
<div class="section" id="movielense-dataset">
<h3>MovieLense dataset<a class="headerlink" href="#movielense-dataset" title="Permalink to this headline">¶</a></h3>
<p>You can download dataset from here: https://grouplens.org/datasets/movielens/latest/</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ratings</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;ml-latest-small/ratings.csv&#39;</span><span class="p">)</span>
<span class="n">movies</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;ml-latest-small/movies.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Limit to top movies so that we don&#39;t run out of memory</span>
<span class="n">n_movies</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">movie_idx_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="p">:</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ratings</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;movieId&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="n">n_movies</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">)}</span>
<span class="n">ratings</span> <span class="o">=</span> <span class="n">ratings</span><span class="p">[</span><span class="n">ratings</span><span class="o">.</span><span class="n">movieId</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">movie_idx_map</span><span class="p">)]</span>

<span class="c1"># Create matrix</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_users</span><span class="p">,</span> <span class="n">n_movies</span><span class="p">))</span>
<span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">ratings</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
    <span class="n">X</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">movie_idx_map</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="p">)]]</span> <span class="o">=</span> <span class="n">r</span>
</pre></div>
</div>
</div>
</div>
<p>Using SVD we will extract movie to concept similarities.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">U</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">V</span><span class="p">[:</span><span class="n">k</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="n">movies</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">movie_idx_map</span><span class="p">]</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>title</th>
      <th>Pay It Forward (2000)</th>
      <th>X-Men Origins: Wolverine (2009)</th>
      <th>Death Proof (2007)</th>
      <th>Virgin Suicides, The (1999)</th>
      <th>Lost Boys, The (1987)</th>
      <th>Bad Santa (2003)</th>
      <th>Rocky II (1979)</th>
      <th>About Schmidt (2002)</th>
      <th>21 Jump Street (2012)</th>
      <th>Buffy the Vampire Slayer (1992)</th>
      <th>...</th>
      <th>Schindler's List (1993)</th>
      <th>Terminator 2: Judgment Day (1991)</th>
      <th>Braveheart (1995)</th>
      <th>Jurassic Park (1993)</th>
      <th>Star Wars: Episode IV - A New Hope (1977)</th>
      <th>Matrix, The (1999)</th>
      <th>Silence of the Lambs, The (1991)</th>
      <th>Pulp Fiction (1994)</th>
      <th>Shawshank Redemption, The (1994)</th>
      <th>Forrest Gump (1994)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.013740</td>
      <td>-0.013834</td>
      <td>-0.014479</td>
      <td>-0.014837</td>
      <td>-0.015855</td>
      <td>-0.016608</td>
      <td>-0.015443</td>
      <td>-0.012657</td>
      <td>-0.013055</td>
      <td>-0.010631</td>
      <td>...</td>
      <td>-0.076227</td>
      <td>-0.081979</td>
      <td>-0.077771</td>
      <td>-0.080885</td>
      <td>-0.099899</td>
      <td>-0.105711</td>
      <td>-0.095243</td>
      <td>-0.107111</td>
      <td>-0.105981</td>
      <td>-0.109809</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.011250</td>
      <td>-0.024457</td>
      <td>-0.024160</td>
      <td>0.000844</td>
      <td>0.008939</td>
      <td>-0.009214</td>
      <td>0.001750</td>
      <td>0.004903</td>
      <td>-0.030972</td>
      <td>0.002863</td>
      <td>...</td>
      <td>0.048985</td>
      <td>0.078242</td>
      <td>0.095468</td>
      <td>0.092870</td>
      <td>0.023382</td>
      <td>-0.035287</td>
      <td>0.075200</td>
      <td>0.066094</td>
      <td>0.032788</td>
      <td>0.051767</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.001458</td>
      <td>-0.007746</td>
      <td>-0.001571</td>
      <td>0.018164</td>
      <td>0.021655</td>
      <td>0.009750</td>
      <td>0.015829</td>
      <td>0.017258</td>
      <td>-0.011936</td>
      <td>0.007625</td>
      <td>...</td>
      <td>-0.052819</td>
      <td>-0.080936</td>
      <td>-0.131230</td>
      <td>-0.105519</td>
      <td>0.015748</td>
      <td>-0.002344</td>
      <td>-0.065713</td>
      <td>-0.083778</td>
      <td>-0.134976</td>
      <td>-0.150658</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.020321</td>
      <td>-0.012819</td>
      <td>-0.009553</td>
      <td>-0.007793</td>
      <td>-0.019447</td>
      <td>-0.020242</td>
      <td>-0.013159</td>
      <td>-0.014629</td>
      <td>-0.017410</td>
      <td>-0.023973</td>
      <td>...</td>
      <td>0.140400</td>
      <td>0.049982</td>
      <td>0.091585</td>
      <td>0.011390</td>
      <td>0.060125</td>
      <td>0.127014</td>
      <td>0.167883</td>
      <td>0.197865</td>
      <td>0.203880</td>
      <td>0.115254</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.023331</td>
      <td>-0.018597</td>
      <td>-0.008455</td>
      <td>0.047220</td>
      <td>0.004637</td>
      <td>0.002883</td>
      <td>-0.008537</td>
      <td>0.013256</td>
      <td>0.000489</td>
      <td>0.002727</td>
      <td>...</td>
      <td>0.072136</td>
      <td>-0.125815</td>
      <td>-0.055847</td>
      <td>-0.051397</td>
      <td>-0.139230</td>
      <td>-0.105409</td>
      <td>0.021655</td>
      <td>0.049932</td>
      <td>0.072611</td>
      <td>0.044770</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.018199</td>
      <td>-0.036357</td>
      <td>-0.043401</td>
      <td>-0.001917</td>
      <td>-0.012641</td>
      <td>-0.043390</td>
      <td>-0.033525</td>
      <td>-0.009536</td>
      <td>-0.038427</td>
      <td>-0.014844</td>
      <td>...</td>
      <td>0.060634</td>
      <td>0.007255</td>
      <td>0.010162</td>
      <td>0.021724</td>
      <td>0.104246</td>
      <td>0.158481</td>
      <td>-0.006284</td>
      <td>-0.027659</td>
      <td>0.048065</td>
      <td>0.075252</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.001026</td>
      <td>-0.011047</td>
      <td>0.005113</td>
      <td>0.009880</td>
      <td>0.017532</td>
      <td>0.023910</td>
      <td>-0.020644</td>
      <td>0.004396</td>
      <td>-0.027700</td>
      <td>0.005198</td>
      <td>...</td>
      <td>-0.037308</td>
      <td>0.009797</td>
      <td>0.045087</td>
      <td>-0.020993</td>
      <td>-0.095660</td>
      <td>0.016492</td>
      <td>-0.034036</td>
      <td>0.048123</td>
      <td>-0.014165</td>
      <td>-0.047230</td>
    </tr>
    <tr>
      <th>7</th>
      <td>-0.003380</td>
      <td>0.008470</td>
      <td>-0.000499</td>
      <td>0.020740</td>
      <td>-0.012323</td>
      <td>-0.002078</td>
      <td>-0.004215</td>
      <td>0.026335</td>
      <td>-0.042955</td>
      <td>-0.007411</td>
      <td>...</td>
      <td>-0.032278</td>
      <td>0.038842</td>
      <td>-0.010127</td>
      <td>0.004377</td>
      <td>-0.011656</td>
      <td>-0.045959</td>
      <td>-0.038364</td>
      <td>-0.037230</td>
      <td>-0.065388</td>
      <td>-0.107479</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.034645</td>
      <td>0.006897</td>
      <td>0.000399</td>
      <td>0.019876</td>
      <td>-0.012274</td>
      <td>-0.003739</td>
      <td>0.008065</td>
      <td>0.018824</td>
      <td>-0.024425</td>
      <td>-0.005707</td>
      <td>...</td>
      <td>0.104706</td>
      <td>-0.029340</td>
      <td>0.022012</td>
      <td>-0.042776</td>
      <td>-0.051743</td>
      <td>-0.032488</td>
      <td>-0.017145</td>
      <td>-0.089404</td>
      <td>-0.002659</td>
      <td>-0.003673</td>
    </tr>
    <tr>
      <th>9</th>
      <td>-0.015903</td>
      <td>0.000305</td>
      <td>-0.005696</td>
      <td>-0.043266</td>
      <td>-0.012414</td>
      <td>0.025808</td>
      <td>0.003037</td>
      <td>0.007873</td>
      <td>-0.030505</td>
      <td>-0.010252</td>
      <td>...</td>
      <td>-0.023747</td>
      <td>-0.014477</td>
      <td>-0.053049</td>
      <td>0.039673</td>
      <td>0.068472</td>
      <td>-0.119593</td>
      <td>-0.020346</td>
      <td>-0.000522</td>
      <td>0.055144</td>
      <td>-0.070372</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0.001406</td>
      <td>-0.005298</td>
      <td>0.008760</td>
      <td>-0.017152</td>
      <td>0.023984</td>
      <td>0.002957</td>
      <td>0.023398</td>
      <td>-0.003396</td>
      <td>-0.028628</td>
      <td>0.008408</td>
      <td>...</td>
      <td>0.073421</td>
      <td>0.051356</td>
      <td>0.043076</td>
      <td>0.075722</td>
      <td>-0.150913</td>
      <td>-0.007862</td>
      <td>0.075812</td>
      <td>0.016360</td>
      <td>-0.014274</td>
      <td>0.058397</td>
    </tr>
    <tr>
      <th>11</th>
      <td>-0.012716</td>
      <td>0.004792</td>
      <td>-0.004085</td>
      <td>-0.017034</td>
      <td>-0.006017</td>
      <td>-0.012858</td>
      <td>-0.005998</td>
      <td>0.020699</td>
      <td>0.010918</td>
      <td>-0.011023</td>
      <td>...</td>
      <td>-0.103410</td>
      <td>0.036463</td>
      <td>0.013066</td>
      <td>0.045016</td>
      <td>-0.117291</td>
      <td>-0.025093</td>
      <td>-0.035659</td>
      <td>-0.004290</td>
      <td>0.023100</td>
      <td>0.065313</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0.005869</td>
      <td>0.003650</td>
      <td>-0.018529</td>
      <td>0.011077</td>
      <td>0.043176</td>
      <td>-0.007125</td>
      <td>0.034755</td>
      <td>0.027206</td>
      <td>-0.027423</td>
      <td>0.021144</td>
      <td>...</td>
      <td>0.056853</td>
      <td>-0.016323</td>
      <td>0.031125</td>
      <td>-0.072646</td>
      <td>0.001670</td>
      <td>0.032127</td>
      <td>-0.013684</td>
      <td>-0.056567</td>
      <td>0.064341</td>
      <td>0.007135</td>
    </tr>
    <tr>
      <th>13</th>
      <td>-0.005996</td>
      <td>-0.002491</td>
      <td>-0.031717</td>
      <td>-0.011993</td>
      <td>-0.009330</td>
      <td>0.035608</td>
      <td>0.018394</td>
      <td>0.009139</td>
      <td>-0.028074</td>
      <td>0.018422</td>
      <td>...</td>
      <td>0.049781</td>
      <td>-0.116128</td>
      <td>0.010845</td>
      <td>-0.097686</td>
      <td>-0.010207</td>
      <td>0.063918</td>
      <td>0.007434</td>
      <td>0.061586</td>
      <td>0.121899</td>
      <td>-0.015993</td>
    </tr>
    <tr>
      <th>14</th>
      <td>0.012578</td>
      <td>0.013483</td>
      <td>0.013961</td>
      <td>-0.032025</td>
      <td>-0.004451</td>
      <td>0.006539</td>
      <td>-0.009263</td>
      <td>0.027288</td>
      <td>0.005632</td>
      <td>-0.006778</td>
      <td>...</td>
      <td>0.104836</td>
      <td>-0.010010</td>
      <td>-0.052742</td>
      <td>0.036469</td>
      <td>-0.031710</td>
      <td>0.062999</td>
      <td>0.044498</td>
      <td>-0.048006</td>
      <td>0.126826</td>
      <td>0.097512</td>
    </tr>
    <tr>
      <th>15</th>
      <td>-0.022066</td>
      <td>-0.011581</td>
      <td>-0.008359</td>
      <td>-0.021246</td>
      <td>-0.049890</td>
      <td>-0.026701</td>
      <td>0.019088</td>
      <td>-0.028568</td>
      <td>-0.017048</td>
      <td>-0.003622</td>
      <td>...</td>
      <td>-0.116622</td>
      <td>-0.023241</td>
      <td>-0.036634</td>
      <td>-0.007887</td>
      <td>0.001071</td>
      <td>-0.030090</td>
      <td>-0.133939</td>
      <td>0.014331</td>
      <td>-0.122462</td>
      <td>0.021362</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0.038829</td>
      <td>-0.020619</td>
      <td>0.002479</td>
      <td>0.020015</td>
      <td>0.026402</td>
      <td>0.008829</td>
      <td>-0.025848</td>
      <td>-0.012024</td>
      <td>0.003265</td>
      <td>0.016658</td>
      <td>...</td>
      <td>0.063076</td>
      <td>0.071958</td>
      <td>0.090464</td>
      <td>0.019738</td>
      <td>0.161150</td>
      <td>0.111749</td>
      <td>0.083454</td>
      <td>0.047222</td>
      <td>0.108038</td>
      <td>0.010785</td>
    </tr>
    <tr>
      <th>17</th>
      <td>0.000813</td>
      <td>-0.012850</td>
      <td>0.006854</td>
      <td>-0.039239</td>
      <td>0.003861</td>
      <td>0.031964</td>
      <td>0.001517</td>
      <td>0.026608</td>
      <td>0.017589</td>
      <td>-0.012412</td>
      <td>...</td>
      <td>0.070014</td>
      <td>0.051948</td>
      <td>0.056400</td>
      <td>0.053108</td>
      <td>0.037174</td>
      <td>-0.006092</td>
      <td>0.032793</td>
      <td>0.002472</td>
      <td>0.074182</td>
      <td>0.121479</td>
    </tr>
    <tr>
      <th>18</th>
      <td>-0.001690</td>
      <td>-0.025183</td>
      <td>0.003327</td>
      <td>-0.006692</td>
      <td>-0.009529</td>
      <td>0.011259</td>
      <td>-0.006495</td>
      <td>0.008801</td>
      <td>0.015817</td>
      <td>-0.005609</td>
      <td>...</td>
      <td>-0.007602</td>
      <td>0.040582</td>
      <td>0.062397</td>
      <td>0.064944</td>
      <td>0.074414</td>
      <td>0.051338</td>
      <td>-0.116508</td>
      <td>-0.031266</td>
      <td>-0.054048</td>
      <td>0.033933</td>
    </tr>
    <tr>
      <th>19</th>
      <td>0.018182</td>
      <td>-0.028629</td>
      <td>0.016610</td>
      <td>-0.009220</td>
      <td>0.019316</td>
      <td>0.022267</td>
      <td>-0.018684</td>
      <td>0.002331</td>
      <td>-0.007455</td>
      <td>0.009498</td>
      <td>...</td>
      <td>-0.151109</td>
      <td>0.061828</td>
      <td>-0.042816</td>
      <td>-0.049376</td>
      <td>-0.040697</td>
      <td>-0.008625</td>
      <td>-0.050223</td>
      <td>-0.085286</td>
      <td>0.016505</td>
      <td>-0.015445</td>
    </tr>
  </tbody>
</table>
<p>20 rows × 1000 columns</p>
</div></div></div>
</div>
<p>Now using any distance measure we can try to extract similar movies directly from V!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">data</span> <span class="o">-</span> <span class="n">data</span><span class="p">[[</span><span class="s1">&#39;Toy Story (1995)&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>title
Toy Story (1995)                              0.000000
Toy Story 2 (1999)                            0.002411
Nutty Professor, The (1996)                   0.002757
Twister (1996)                                0.002821
Willy Wonka &amp; the Chocolate Factory (1971)    0.002958
Hunchback of Notre Dame, The (1996)           0.003167
Bug&#39;s Life, A (1998)                          0.003306
Multiplicity (1996)                           0.003310
Dragonheart (1996)                            0.003376
Rumble in the Bronx (Hont faan kui) (1995)    0.003380
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">data</span> <span class="o">-</span> <span class="n">data</span><span class="p">[[</span><span class="s1">&#39;Matrix, The (1999)&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>title
Matrix, The (1999)                                           0.000000
Fight Club (1999)                                            0.003215
Saving Private Ryan (1998)                                   0.003370
Gladiator (2000)                                             0.003589
Star Wars: Episode I - The Phantom Menace (1999)             0.003986
Star Wars: Episode V - The Empire Strikes Back (1980)        0.004086
Lord of the Rings: The Fellowship of the Ring, The (2001)    0.004136
Payback (1999)                                               0.004558
Memento (2000)                                               0.004605
Intouchables (2011)                                          0.004631
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>I hope that all these examples illustrate how a relatively simple principle can have far reaching applications. Most importantly this shows that linear algebra is powerful tool and matrixes hold a power to do impressive things. We will see later that neural networks are build from these concepts.</p>
</div>
</div>
<div class="section" id="re-sources">
<h2>(re)Sources<a class="headerlink" href="#re-sources" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://medium.com/&#64;jonathan_hui/machine-learning-singular-value-decomposition-svd-principal-component-analysis-pca-1d45e885e491">SVD math basics</a> or the <a class="reference external" href="https://towardsdatascience.com/understanding-singular-value-decomposition-and-its-application-in-data-science-388a54be95d">extended</a> version.</p></li>
<li><p><a class="reference external" href="https://www.rose-hulman.edu/~bryan/googleFinalVersionFixed.pdf">Paper - THE $25,000,000,000∗ EIGENVECTOR THE LINEAR ALGEBRA BEHIND GOOGLE</a></p></li>
<li><p><a class="reference external" href="https://youtu.be/Qz58vTa8-SY">Video - A primer (or refresher) on linear algebra</a></p></li>
<li><p><a class="reference external" href="https://slideplayer.com/slide/5283216/">Slides - Dimensionality Reduction PCA – SVD</a></p></li>
<li><p><a class="reference external" href="https://hackernoon.com/introduction-to-recommender-system-part-1-collaborative-filtering-singular-value-decomposition-44c9659c5e75">Blog - Introduction to Recommender System. Part 1 (Collaborative Filtering, Singular Value Decomposition)</a></p></li>
<li><p><a class="reference external" href="http://fourier.eng.hmc.edu/e161/lectures/svdcompression.html">Blog - Image Compression with SVD</a></p></li>
</ul>
</div>
</div>


              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="README.html" title="previous page">Welcome to AI primer course</a>
    <a class='right-next' id="next-link" href="RF.html" title="next page">RF (Random Forest)</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By trokas<br/>
        
            &copy; Copyright MIF, 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="_static/js/index.js"></script>
    
  </body>
</html>